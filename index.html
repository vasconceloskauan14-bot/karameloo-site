
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Karamelo | Edi√ß√£o Profissional</title>

  <style>
    :root{
      --bg:#070b18;
      --panel:#0b1226;
      --text:#e5e7eb;
      --muted:#9ca3af;

      --accent1:#7c3aed; /* roxo */
      --accent2:#2563eb; /* azul */
      --accent3:#38bdf8; /* ciano */

      --border:rgba(255,255,255,.12);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      color:var(--text);
      overflow-x:hidden;
      color-scheme: dark;
      background: var(--bg);
      position:relative;
    }

    /* ‚úÖ Fundo degrad√™ 3 cores (fosco) */
    .bg{
      position:fixed; inset:0; z-index:-3;
      background:
        radial-gradient(1200px 800px at 12% 10%, rgba(124,58,237,.34), transparent 62%),
        radial-gradient(1200px 800px at 88% 12%, rgba(37,99,235,.30), transparent 62%),
        radial-gradient(1100px 900px at 50% 85%, rgba(56,189,248,.16), transparent 62%),
        linear-gradient(135deg, rgba(124,58,237,.18) 0%, rgba(37,99,235,.16) 48%, rgba(56,189,248,.10) 100%),
        linear-gradient(180deg, rgba(7,11,24,.98), rgba(5,8,18,.99));
      filter:saturate(1.1);
    }

    /* ‚úÖ Orbs animadas leves */
    .orb{
      position:fixed;
      width:520px; height:520px;
      border-radius:50%;
      z-index:-2;
      opacity:.34;
      filter: blur(22px);
      animation: float 14s ease-in-out infinite;
      pointer-events:none;
      transform: translateZ(0);
      will-change: transform;
      mix-blend-mode: screen;
    }
    .orb.one{
      left:-180px; top:130px;
      background: radial-gradient(circle at 35% 35%, rgba(124,58,237,.92), rgba(124,58,237,0) 60%);
      animation-duration: 16s;
    }
    .orb.two{
      right:-240px; top:60px;
      background: radial-gradient(circle at 40% 35%, rgba(37,99,235,.90), rgba(37,99,235,0) 60%);
      animation-duration: 18s;
      animation-delay: -3s;
    }
    .orb.three{
      left:22%; bottom:-280px;
      width:680px; height:680px;
      background: radial-gradient(circle at 50% 40%, rgba(56,189,248,.70), rgba(56,189,248,0) 62%);
      animation-duration: 20s;
      animation-delay: -5s;
    }
    @keyframes float{
      0%{ transform: translate3d(0,0,0) scale(1); }
      50%{ transform: translate3d(0,-16px,0) scale(1.02); }
      100%{ transform: translate3d(0,0,0) scale(1); }
    }

    /* ‚úÖ Sparkles leves */
    .sparkles{
      position:fixed; inset:0; z-index:-1;
      pointer-events:none;
      opacity:.18;
      background-image:
        radial-gradient(circle, rgba(255,255,255,.24) 1px, transparent 1.8px),
        radial-gradient(circle, rgba(56,189,248,.15) 1px, transparent 1.8px);
      background-size: 76px 76px, 100px 100px;
      background-position: 0 0, 28px 22px;
      will-change: transform;
      transform: translateZ(0);
      animation: drift 28s linear infinite;
    }
    @keyframes drift{
      from{ transform: translate3d(0,0,0); }
      to{ transform: translate3d(-80px, -60px, 0); }
    }

    /* ‚úÖ Entrada */
    .page{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      opacity:0;
      transform: translateY(8px);
      animation: pageIn .55s ease forwards;
    }
    @keyframes pageIn{to{opacity:1; transform:translateY(0)}}

    header{
      padding:44px 18px 28px;
      background: linear-gradient(90deg,
        rgba(124,58,237,.55),
        rgba(37,99,235,.50),
        rgba(56,189,248,.25)
      );
      border-bottom:1px solid rgba(255,255,255,.12);
    }
    .wrap{max-width:1100px;margin:0 auto}
    h1{
      margin:0;
      font-size: clamp(2rem, 3.4vw, 3rem);
      letter-spacing:.3px;
    }
    .subtitle{
      margin-top:10px;
      color: rgba(229,231,235,.9);
      font-size:1.05rem;
    }

    main{padding:26px 18px 60px; position:relative;}
    main::before{
      content:"";
      position:absolute; inset:0;
      background: rgba(2,6,23,.18);
      pointer-events:none;
    }
    main > .wrap{position:relative; z-index:1;}

    .screen{display:none;opacity:0;transform: translateY(10px);}
    .screen.show{display:block;animation: screenIn .35s ease forwards;}
    @keyframes screenIn{to{opacity:1;transform:translateY(0)}}

    .hero{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:18px;
      align-items:stretch;
    }
    @media (max-width: 860px){ .hero{grid-template-columns:1fr} }

    /* ‚úÖ CARD OTIMIZADO */
    .card{
      background: linear-gradient(180deg, rgba(11,18,38,.92), rgba(10,16,34,.88));
      border:1px solid var(--border);
      border-radius:18px;
      padding:18px;
      box-shadow: 0 10px 26px rgba(0,0,0,.35);
      content-visibility: auto;
      contain-intrinsic-size: 320px 220px;
      contain: layout paint style;
    }
    .card h3{margin:0 0 8px;font-size:1.15rem;color:#c7d2fe;}
    .card p{margin:0;color:var(--muted);line-height:1.35}

    .btn{
      margin-top:14px;
      width:100%;
      padding:12px 14px;
      border:none;
      border-radius:12px;
      background: linear-gradient(90deg, var(--accent1), var(--accent2));
      color:white;
      font-weight:700;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
    }
    .btn:hover{transform: translateY(-1px); filter: brightness(1.04);}
    .btn:active{transform: translateY(0px); filter: brightness(.98);}
    .btn.secondary{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.14);
      color: var(--text);
    }
    .btn.small{
      width:auto;
      padding:10px 12px;
      border-radius:12px;
      margin-top:0;
      font-size:.95rem;
    }

    .section-title{margin:26px 0 12px; color:#c7d2fe; font-size:1.25rem;}
    .pill{display:inline-block;margin-top:6px;color:var(--muted);font-size:.95rem;}

    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:14px;
    }
    @media (max-width: 980px){ .grid{grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 620px){ .grid{grid-template-columns: 1fr;} }
    .grid .full{grid-column: 1 / -1;}

    .price{margin:10px 0 10px;font-weight:900;font-size:1.25rem;color: var(--accent3);}
    ul{margin:10px 0 0; padding-left:18px; color:#cbd5e1}
    li{margin:6px 0}

    .card.highlight{
      border:1px solid rgba(56,189,248,.35);
      box-shadow:0 12px 28px rgba(0,0,0,.38), 0 0 0 4px rgba(56,189,248,.05);
    }

    .overlay{
      position:fixed; inset:0;
      background: rgba(0,0,0,.62);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:1000;
    }
    .overlay.show{display:flex; animation: fadeIn .2s ease forwards;}
    .overlay.closing{animation: fadeOut .22s ease forwards;}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    @keyframes fadeOut{from{opacity:1}to{opacity:0}}

    .modal{
      width:min(520px, 100%);
      background: linear-gradient(180deg, rgba(11,18,38,.95), rgba(10,16,34,.92));
      border:1px solid rgba(255,255,255,.16);
      border-radius:18px;
      box-shadow: 0 30px 80px rgba(0,0,0,.60);
      overflow:hidden;
      transform: translateY(10px) scale(.98);
      opacity:0;
      animation: modalIn .25s ease forwards;
    }
    .modal.closing{animation: modalOut .22s ease forwards;}
    @keyframes modalIn{to{opacity:1;transform:translateY(0) scale(1)}}
    @keyframes modalOut{to{opacity:0;transform:translateY(8px) scale(.98)}}

    .modalHead{
      padding:16px 18px;
      background: linear-gradient(90deg, rgba(124,58,237,.72), rgba(37,99,235,.72));
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .modalHead strong{font-size:1.05rem}
    .close{
      width:36px;height:36px;
      border-radius:12px;
      border:none;
      cursor:pointer;
      background: rgba(255,255,255,.14);
      color:white;
      font-size:18px;
    }
    .modalBody{padding:18px}

    /* ‚úÖ Mobile: evita cortar o formul√°rio (sem mudar o visual, s√≥ permite rolagem) */
    @media (max-width: 560px){
      .modal{
        max-height: calc(100vh - 24px);
        display:flex;
        flex-direction:column;
      }
      .modalBody{
        overflow:auto;
        -webkit-overflow-scrolling: touch;
        padding:16px;
        padding-bottom: max(16px, env(safe-area-inset-bottom));
      }
    }


    /* ===== Modal: Cadastro <-> Login (anima√ß√£o premium) ===== */
    .authWrap{
      position:relative;
      min-height:520px;
      overflow:hidden; /* evita ‚Äúvazar‚Äù durante a transi√ß√£o */
    }

    .authView{
      position:absolute;
      inset:0;
      opacity:0;
      transform: translateX(28px) scale(.985);
      filter: blur(10px);
      pointer-events:none;
      will-change: transform, opacity, filter;
    }

    .authView.active{
      pointer-events:auto;
      /* evita ‚Äútela preta‚Äù no celular: view ativa precisa ficar vis√≠vel */
      opacity: 1;
      transform: translateX(0) scale(1);
      filter: blur(0);
      z-index:2;
    }

    /* anima√ß√µes com blur + easing (bem fluida) */
    @keyframes authInRight{
      from{ opacity:0; transform: translateX(40px) scale(.98); filter: blur(12px); }
      to  { opacity:1; transform: translateX(0) scale(1);     filter: blur(0); }
    }
    @keyframes authInLeft{
      from{ opacity:0; transform: translateX(-40px) scale(.98); filter: blur(12px); }
      to  { opacity:1; transform: translateX(0) scale(1);       filter: blur(0); }
    }
    @keyframes authOutLeft{
      from{ opacity:1; transform: translateX(0) scale(1);       filter: blur(0); }
      to  { opacity:0; transform: translateX(-40px) scale(.98); filter: blur(12px); }
    }
    @keyframes authOutRight{
      from{ opacity:1; transform: translateX(0) scale(1);      filter: blur(0); }
      to  { opacity:0; transform: translateX(40px) scale(.98); filter: blur(12px); }
    }

    .authView.enterRight{ animation: authInRight .34s cubic-bezier(.16,1,.2,1) both; }
    .authView.enterLeft { animation: authInLeft  .34s cubic-bezier(.16,1,.2,1) both; }
    .authView.leaveLeft { animation: authOutLeft .30s cubic-bezier(.4,0,.2,1) both; }
    .authView.leaveRight{ animation: authOutRight .30s cubic-bezier(.4,0,.2,1) both; }



    .linkBtn{
      background:none; border:none; padding:0;
      color: rgba(56,189,248,.95);
      font-weight:900;
      cursor:pointer;
      text-decoration:none;
    }
    .linkBtn:hover{ text-decoration:underline; }

    /* ===== Personalizado: mostrar menos/mais ===== */
    .hidden{ display:none !important; }
    .collapsed{ display:none !important; }
    .field{margin-bottom:12px}
    .field label{display:block;font-size:.88rem;color:#cbd5e1;margin:0 0 6px}

    input, textarea, select{
      width:100%;
      padding:11px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      outline:none;
      color-scheme: dark;
    }
    textarea{min-height:96px; resize:vertical;}
    input::placeholder, textarea::placeholder{color: rgba(229,231,235,.68)}
    input:focus, textarea:focus, select:focus{border-color: rgba(56,189,248,.55)}
    select option{background: var(--panel); color: var(--text);}
    input[type="date"]::-webkit-datetime-edit{ color: var(--text); }
    input[type="date"]::-webkit-calendar-picker-indicator{filter: invert(1);opacity:.85;cursor:pointer;}
    .hint{color:var(--muted); font-size:.9rem; margin-top:10px}

    .mini-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .mini label{display:block;font-size:.88rem;color:#cbd5e1;margin:0 0 6px}

    .checks{display:grid;gap:8px}
    .chk{display:flex;gap:10px;align-items:center;color:#cbd5e1;font-size:.95rem}
    .chk input{width:auto;margin:0}

    .total-box{
      margin-top:12px;
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(56,189,248,.22);
      background: rgba(56,189,248,.06);
    }
    .total-line{display:flex;justify-content:space-between;align-items:center}
    .total-line strong{font-size:1.25rem;color:var(--accent3)}
    .total-sub{margin-top:6px;color:var(--muted);font-size:.95rem}

    footer{padding:18px;color:rgba(229,231,235,.7);text-align:center;}

    /* ‚úÖ MODO LEVE AUTOM√ÅTICO */
    @media (prefers-reduced-motion: reduce){
      .orb, .sparkles{ animation: none !important; }
    }
    @media (max-width: 900px){
      .sparkles{ display:none; }
      .orb{ filter: blur(16px); opacity:.28; }
    }

    /* ===== Avatares + Estrelas ===== */
    .who{
      display:flex; align-items:center; gap:10px;
      margin-top:10px;
    }
    .avatar{
      width:44px; height:44px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background:
        radial-gradient(circle at 30% 30%, rgba(56,189,248,.55), transparent 55%),
        radial-gradient(circle at 70% 70%, rgba(124,58,237,.55), transparent 55%),
        rgba(255,255,255,.06);
      box-shadow: 0 10px 24px rgba(0,0,0,.35);
      overflow:hidden;
      flex:0 0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
      color:rgba(229,231,235,.92);
    }
    .avatar img{width:100%;height:100%;object-fit:cover;display:block;}
    .who .meta{display:flex;flex-direction:column;gap:2px}
    .stars{
      display:inline-flex; gap:3px; align-items:center;
      font-size:14px;
      letter-spacing:.2px;
      flex-wrap:wrap;
      max-width: 100%;
    }
    .star{
      color: rgba(56,189,248,.95);
      text-shadow: 0 0 10px rgba(56,189,248,.25);
    }
    .star.off{
      color: rgba(229,231,235,.28);
      text-shadow:none;
    }
    .stars small{
      color: rgba(229,231,235,.70);
      margin-left:8px;
      font-size:.9rem;
      font-weight:700;
    }

    /* ===== B: Sele√ß√£o de Editores (Cliente) ===== */
    .toolbar{
      display:flex; gap:10px; flex-wrap:wrap;
      align-items:center; justify-content:space-between;
      margin-top:12px;
    }
    .toolbar .left, .toolbar .right{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    .chip{
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:#e5e7eb;
      font-size:.92rem;
    }
    .editor-cards{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:14px;
      margin-top:12px;
    }
    @media (max-width: 980px){ .editor-cards{grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 620px){ .editor-cards{grid-template-columns: 1fr;} }

    .eCard{
      background: linear-gradient(180deg, rgba(11,18,38,.92), rgba(10,16,34,.88));
      border:1px solid rgba(255,255,255,.12);
      border-radius:18px;
      padding:14px;
      box-shadow: 0 10px 26px rgba(0,0,0,.35);
      content-visibility:auto;
      contain-intrinsic-size: 320px 280px;
      contain: layout paint style;
    }
    .eTop{display:flex; justify-content:space-between; align-items:flex-start; gap:10px;}
    .eName{font-weight:900; color:#e5e7eb; font-size:1.05rem}
    .eMeta{color:rgba(229,231,235,.70); font-size:.92rem; margin-top:4px}
    .eBio{margin-top:10px;color:rgba(156,163,175,.95);line-height:1.35;font-size:.95rem;}
    .eBadges{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px;}
    .badge{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:#e5e7eb;
      font-size:.9rem;
    }
    .badge.pillBlue{border-color: rgba(124,58,237,.30);background: rgba(124,58,237,.10);}
    .badge.you{border-color: rgba(56,189,248,.30);background: rgba(56,189,248,.10);}
    .badge.off{opacity:.6}

    /* ===== Editor Dashboard ===== */
    .editor-grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:14px;
      margin-top:14px;
      align-items:start;
    }
    @media (max-width: 860px){ .editor-grid{grid-template-columns:1fr;} }

    .kpi{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap:10px;
      margin-top:10px;
    }
    .kpi .k{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      border-radius:14px;
      padding:10px;
      min-height:66px;
    }
    .k .t{color:rgba(229,231,235,.72); font-size:.85rem}
    .k .v{font-weight:900; margin-top:6px; font-size:1.05rem; color:#c7d2fe}
    .k .v small{font-weight:700; color:rgba(229,231,235,.75); font-size:.9rem}

    .row-inline{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
    }

    .switch{
      display:inline-flex; align-items:center; gap:10px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      user-select:none;
    }
    .switch input{ display:none; }
    .track{
      width:44px; height:24px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      position:relative;
      transition: .15s ease;
      flex:0 0 auto;
    }
    .thumb{
      width:18px; height:18px; border-radius:50%;
      position:absolute; top:50%; transform: translateY(-50%);
      left:3px;
      background: rgba(229,231,235,.85);
      transition: .15s ease;
      box-shadow: 0 6px 16px rgba(0,0,0,.35);
    }
    .switch input:checked + .track{
      background: rgba(56,189,248,.16);
      border-color: rgba(56,189,248,.35);
    }
    .switch input:checked + .track .thumb{
      left:23px;
      background: rgba(56,189,248,.95);
      box-shadow: 0 0 16px rgba(56,189,248,.35);
    }
    .switch .label{
      color:#e5e7eb; font-weight:800; font-size:.95rem;
    }
    .switch .sub{
      color:rgba(229,231,235,.72); font-size:.85rem; margin-top:2px;
    }

    .tags{
      display:flex; flex-wrap:wrap; gap:8px;
      margin-top:8px;
    }
    .tag{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:#e5e7eb;
      font-size:.88rem;
    }
    .tag.blue{
      border-color: rgba(56,189,248,.25);
      background: rgba(56,189,248,.08);
    }

    .pkg-list{display:grid; gap:10px; margin-top:10px;}

    /* ‚úÖ THUMB (preenche o vazio) + layout */
    .pkg-item{
      display:grid;
      grid-template-columns: 92px 1fr;
      gap:14px;
      align-items:start;
      padding:10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
    }
    .pkg-thumb{
      width:88px;
      height:88px;
      border-radius:14px;
      background:
        radial-gradient(circle at 30% 30%, rgba(56,189,248,.35), transparent 60%),
        radial-gradient(circle at 70% 70%, rgba(124,58,237,.35), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 10px 24px rgba(0,0,0,.35);
      flex-shrink:0;
    }
    .pkg-item input{ margin-top:4px; width:auto; }
    .pkg-title{ font-weight:900; color:#e5e7eb }
    .pkg-sub{ color:rgba(229,231,235,.72); font-size:.92rem; margin-top:2px }
    .pkg-meta{ color:rgba(156,163,175,.92); font-size:.9rem; margin-top:6px }

    .uploadRow{
      display:flex; gap:12px; align-items:center; flex-wrap:wrap;
      margin-top:10px;
    }
    .uploadRow .avatar{width:56px;height:56px}

    /* ‚ÄúVer mais‚Äù centralizado */
    .moreRow{
      margin-top:10px;
      display:flex;
      justify-content:center;
    }

    /* ====== ENTRADA (START) MAIS GRANDE / PREMIUM ====== */
    .wrap{ max-width: 1200px; }

    header{
      padding: 78px 18px 56px;
      border-bottom: 1px solid rgba(255,255,255,.12);
    }

    h1{
      font-size: clamp(2.8rem, 5.2vw, 4.2rem);
      letter-spacing: .4px;
    }

    .subtitle{
      margin-top: 14px;
      font-size: 1.18rem;
      max-width: 760px;
      line-height: 1.35;
      color: rgba(229,231,235,.92);
    }

    #screenStart .hero{
      margin-top: 18px;
      position: relative;
    }
    #screenStart .hero::before{
      content:"";
      position:absolute;
      inset: -26px -18px -26px -18px;
      border-radius: 26px;
      background:
        radial-gradient(900px 420px at 20% 0%, rgba(124,58,237,.18), transparent 60%),
        radial-gradient(900px 420px at 80% 0%, rgba(56,189,248,.14), transparent 60%);
      filter: blur(2px);
      pointer-events:none;
      z-index:0;
    }
    #screenStart .hero > *{ position:relative; z-index:1; }

    .startCard{
      padding: 22px 22px 20px;
      border-radius: 22px;
      min-height: 220px;
    }
    .startCard h3{
      font-size: 1.35rem;
      margin-bottom: 10px;
    }
    .startCard p{
      font-size: 1.05rem;
      line-height: 1.45;
    }
    .startCard .btn{
      margin-top: 18px;
      padding: 14px 16px;
      border-radius: 14px;
      font-size: 1.05rem;
    }

    main{ padding: 34px 18px 70px; }

    @media (max-width: 860px){
      header{ padding: 62px 16px 46px; }
      h1{ font-size: clamp(2.4rem, 9vw, 3.3rem); }
      .subtitle{ font-size: 1.06rem; }
      .startCard{ min-height: 210px; }
    }
  

    /* ====== START PRO (Entrada Premium) ====== */
    .startPro{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:18px;
      align-items:start;
      margin-top:18px;
    }
    .startCopy{padding:6px 2px}
    .startBadge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: rgba(229,231,235,.92);
      font-weight:900;
      letter-spacing:.2px;
      width: fit-content;
    }
    .startTitle{
      margin:14px 0 0;
      font-size: clamp(1.9rem, 3.6vw, 2.7rem);
      line-height:1.08;
      letter-spacing:.2px;
    }
    .startDesc{
      margin:10px 0 0;
      color: rgba(229,231,235,.86);
      font-size:1.05rem;
      max-width:56ch;
      line-height:1.4;
    }
    .startChips{display:flex;flex-wrap:wrap;gap:10px;margin-top:14px}
    .startChip{
      padding:9px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      color: rgba(229,231,235,.9);
      font-size:.95rem;
    }
    .startChip strong{color:#e5e7eb;font-weight:900}

    .startMini{margin-top:16px;display:grid;gap:10px}
    .miniCard{
      display:flex;
      gap:12px;
      align-items:flex-start;
      padding:12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }
    .miniIco{
      width:38px;height:38px;
      border-radius:14px;
      display:flex;align-items:center;justify-content:center;
      background: linear-gradient(135deg, rgba(124,58,237,.22), rgba(56,189,248,.14));
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 10px 22px rgba(0,0,0,.28);
      flex:0 0 auto;
    }
    .miniT{font-weight:900;color:#c7d2fe}
    .miniP{margin-top:4px;color:rgba(156,163,175,.95);font-size:.95rem;line-height:1.35}

    .startNote{margin-top:14px;color:rgba(229,231,235,.65);font-size:.92rem}

    .startRoles{display:grid;gap:14px}
    .roleCardPro{
      background: linear-gradient(180deg, rgba(11,18,38,.92), rgba(10,16,34,.88));
      border:1px solid rgba(255,255,255,.12);
      border-radius:20px;
      padding:16px;
      box-shadow: 0 12px 30px rgba(0,0,0,.38);
    }
    .roleTop{display:flex;gap:12px;align-items:center}
    .roleIco{
      width:46px;height:46px;
      border-radius:16px;
      display:flex;align-items:center;justify-content:center;
      background: linear-gradient(135deg, rgba(124,58,237,.25), rgba(37,99,235,.18));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 12px 26px rgba(0,0,0,.32);
    }
    .roleT{font-weight:1000;font-size:1.15rem;color:#e5e7eb}
    .roleS{margin-top:4px;color:rgba(229,231,235,.72);font-size:.95rem}
    .roleList{margin:10px 0 0;padding-left:18px;color:#cbd5e1}
    .roleList li{margin:6px 0}

    @media (max-width: 860px){
      .startPro{grid-template-columns:1fr;margin-top:10px}
      .startCopy{padding:0}
    }

    /* ‚úÖ Ajustes Mobile (entrada mais compacta e premium) */
    @media (max-width: 620px){
      header{ padding: 54px 16px 36px; }
      h1{ font-size: clamp(2.2rem, 10vw, 3rem); }
      .subtitle{ font-size: 1.03rem; }
      main{ padding: 26px 16px 66px; }
      .startTitle{ font-size: clamp(1.85rem, 8.4vw, 2.45rem); }
      .startChip{ font-size:.92rem; padding:8px 10px; }
      .roleCardPro{ padding:14px; }
    }

  

    /* ===== FIX: Modal scroll no celular + botao Continuar grande ===== */
    .modal{ max-height: calc(100vh - 24px); }
    .modalBody{ max-height: calc(100vh - 110px); overflow:auto; -webkit-overflow-scrolling:touch; padding-bottom:22px; }
    #btnCadastrar, #btnLogin{ min-height:56px; font-size:1.05rem; }
    .authLinks{ margin-bottom:10px; }
    @media (max-width: 620px){
      .authWrap{ min-height:unset; }
    }

    /* ===== Portf√≥lio do Editor (at√© 30 fotos / 10 v√≠deos) ===== */
    .work-grid{ display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin-top:10px; }
    @media (max-width: 620px){ .work-grid{ grid-template-columns: repeat(2, 1fr);} }
    .work-item{ aspect-ratio: 1 / 1; border-radius:14px; overflow:hidden; border:1px solid var(--border); background: rgba(0,0,0,.03); }
    .work-item img, .work-item video{ width:100%; height:100%; object-fit:cover; display:block; }

    /* ===== TEMA CLARO DOURADO (mant√©m o layout) ===== */
    :root{
      /* tema claro mais confort√°vel (menos brilho) */
      --bg:#f6f1e6;
      --panel:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --accent1:#d4af37; /* dourado */
      --accent2:#f59e0b; /* amarelo */
      --accent3:#fbbf24; /* amarelo claro */
      --border:rgba(0,0,0,.12);
    }
    body{ color-scheme: light; background: var(--bg); }

    /* fundo claro com enfeites dourados (menos brilho + mais decora√ß√£o) */
    .bg{
      background:
        radial-gradient(1200px 800px at 12% 10%, rgba(212,175,55,.18), transparent 62%),
        radial-gradient(1200px 800px at 88% 12%, rgba(245,158,11,.14), transparent 62%),
        radial-gradient(1100px 900px at 50% 85%, rgba(251,191,36,.10), transparent 62%),
        /* listras bem sutis (ouro) para n√£o ficar ‚Äúvazio‚Äù */
        repeating-linear-gradient(135deg, rgba(212,175,55,.045) 0 1px, transparent 1px 18px),
        linear-gradient(135deg, rgba(212,175,55,.07) 0%, rgba(245,158,11,.06) 48%, rgba(251,191,36,.06) 100%),
        linear-gradient(180deg, rgba(246,241,230,.98), rgba(244,239,229,.99));
      filter:saturate(1.0) brightness(.98);
    }
    .orb{ opacity:.14; mix-blend-mode:multiply; }
    .orb.one{ background: radial-gradient(circle at 35% 35%, rgba(212,175,55,.55), rgba(212,175,55,0) 60%); }
    .orb.two{ background: radial-gradient(circle at 40% 35%, rgba(245,158,11,.48), rgba(245,158,11,0) 60%); }
    .orb.three{ background: radial-gradient(circle at 50% 40%, rgba(251,191,36,.40), rgba(251,191,36,0) 62%); }
    .sparkles{ opacity:.14; background-image:
      radial-gradient(circle, rgba(0,0,0,.10) 1px, transparent 1.8px),
      radial-gradient(circle, rgba(212,175,55,.18) 1px, transparent 1.8px);
    }

    header{
      background: linear-gradient(90deg, rgba(212,175,55,.92), rgba(245,158,11,.86), rgba(251,191,36,.70));
      border-bottom:1px solid rgba(0,0,0,.10);
    }
    /* reduz o ‚Äúbranco estourado‚Äù do conte√∫do */
    main::before{
      background:
        radial-gradient(900px 420px at 20% 6%, rgba(245,158,11,.08), transparent 60%),
        radial-gradient(900px 420px at 80% 10%, rgba(212,175,55,.06), transparent 60%),
        rgba(255,255,255,.18);
    }

    .card, .eCard{
      background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.86));
      border:1px solid rgba(0,0,0,.10);
      box-shadow: 0 10px 26px rgba(17,24,39,.12);
    }

    /* destaque do personalizado: menos ‚Äúbranco chapado‚Äù */
    .card.highlight{
      background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(252,248,236,.88));
      border-color: rgba(245,158,11,.22);
      box-shadow: 0 12px 28px rgba(17,24,39,.14), 0 0 0 4px rgba(245,158,11,.06);
    }
    .total-box{ border-color: rgba(245,158,11,.22); background: rgba(245,158,11,.06); }
    .card h3{ color:#7c5c12; }
    .section-title{ color:#7c5c12; }
    .pill{ color: rgba(17,24,39,.70); }
    .price{ color: #b45309; }

    /* entrada (t√≠tulos/chips) ‚Äî estava com cores do tema escuro */
    .subtitle{ color: rgba(17,24,39,.78); }
    .startTitle{ color: var(--text); }
    .startDesc{ color: rgba(17,24,39,.72); }
    .startChip{
      border:1px solid rgba(0,0,0,.12);
      background: rgba(0,0,0,.03);
      color: rgba(17,24,39,.88);
    }
    .startChip strong{ color:#7c5c12; }
    .miniCard{ border:1px solid rgba(0,0,0,.10); background: rgba(0,0,0,.02); }
    .miniT{ color:#7c5c12; }
    .miniS{ color: rgba(17,24,39,.72); }

    /* legibilidade (editor + listas + checkboxes) */
    .chk{ color: rgba(17,24,39,.78); }
    .card ul, .card li{ color: rgba(17,24,39,.78); }
    .k .t{ color: rgba(17,24,39,.70); }
    .k .v{ color: #7c5c12; }
    .k .v small{ color: rgba(17,24,39,.65); }
    .eName{ color: #111827; }
    .eMeta{ color: rgba(17,24,39,.70); }
    .eBio{ color: rgba(17,24,39,.74); }
    .pkg-sub{ color: rgba(17,24,39,.70); }
    .pkg-meta{ color: rgba(17,24,39,.66); }

    input, textarea, select{
      border:1px solid rgba(0,0,0,.12);
      background: rgba(0,0,0,.03);
      color: var(--text);
      color-scheme: light;
    }
    input::placeholder, textarea::placeholder{ color: rgba(17,24,39,.45); }
    input:focus, textarea:focus, select:focus{ border-color: rgba(245,158,11,.55); }
    select option{ background: #fff; color: var(--text); }
    input[type="date"]::-webkit-calendar-picker-indicator{ filter: none; opacity:.75; }

    .btn{
      background: linear-gradient(90deg, var(--accent1), var(--accent2));
      box-shadow: 0 12px 26px rgba(245,158,11,.18);
    }
    .btn.secondary{
      background: rgba(0,0,0,.03);
      border:1px solid rgba(0,0,0,.12);
      color: var(--text);
    }

    .modal{
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.92));
      border:1px solid rgba(0,0,0,.12);
      box-shadow: 0 30px 80px rgba(17,24,39,.22);
    }
    .modalHead{ background: linear-gradient(90deg, rgba(212,175,55,.95), rgba(245,158,11,.88)); }
    .close{ background: rgba(0,0,0,.06); color: rgba(17,24,39,.9); }
    .overlay{ background: rgba(17,24,39,.42); }

    .avatar{
      border:1px solid rgba(0,0,0,.12);
      background:
        radial-gradient(circle at 30% 30%, rgba(251,191,36,.28), transparent 55%),
        radial-gradient(circle at 70% 70%, rgba(212,175,55,.22), transparent 55%),
        rgba(0,0,0,.02);
      box-shadow: 0 10px 24px rgba(17,24,39,.12);
      color: rgba(17,24,39,.85);
    }
    .star{ color: rgba(180,83,9,.95); text-shadow: 0 0 10px rgba(245,158,11,.22); }
    .star.off{ color: rgba(17,24,39,.20); text-shadow:none; }

    .badge.pillBlue{ border-color: rgba(245,158,11,.30); background: rgba(245,158,11,.10); }
    .badge.you{ border-color: rgba(212,175,55,.35); background: rgba(212,175,55,.14); }

    .chip{ border:1px solid rgba(0,0,0,.12); background: rgba(0,0,0,.03); color: rgba(17,24,39,.88); }
    .switch{ border:1px solid rgba(0,0,0,.12); background: rgba(0,0,0,.03); }
    .track{ border:1px solid rgba(0,0,0,.12); background: rgba(0,0,0,.05); }
    .switch input:checked + .track{ background: rgba(245,158,11,.20); border-color: rgba(245,158,11,.40); }
    .switch input:checked + .track .thumb{ background: rgba(245,158,11,.95); box-shadow: 0 0 16px rgba(245,158,11,.30); }

    footer{ color: rgba(17,24,39,.55); }

    /* ===== IA Karamelo (Cliente + Editor) ===== */
    .aiFab{
      position:fixed;
      right:18px;
      bottom:18px;
      z-index:1400;
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:12px 14px;
      border:none;
      border-radius:999px;
      background: linear-gradient(90deg, var(--accent1), var(--accent2));
      color:#111827;
      font-weight:1000;
      box-shadow: 0 16px 36px rgba(245,158,11,.22);
    }
    .aiFab .dot{
      width:10px;height:10px;border-radius:50%;
      background: rgba(255,255,255,.95);
      box-shadow: 0 0 0 4px rgba(255,255,255,.30);
    }
    .aiPanel{
      position:fixed;
      right:18px;
      bottom:78px;
      width:min(420px, calc(100vw - 36px));
      max-height: min(70vh, 620px);
      display:none;
      flex-direction:column;
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(252,248,236,.92));
      border:1px solid rgba(0,0,0,.10);
      border-radius:18px;
      box-shadow: 0 30px 80px rgba(17,24,39,.22);
      overflow:hidden;
      z-index:1400;
    }
    .aiPanel.show{ display:flex; }
    .aiHead{
      padding:14px 14px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      background: linear-gradient(90deg, rgba(212,175,55,.95), rgba(245,158,11,.88));
      border-bottom:1px solid rgba(0,0,0,.08);
    }
    .aiTitle{ font-weight:1000; color:#111827; }
    .aiSub{ font-size:.9rem; color: rgba(17,24,39,.80); margin-top:2px; }
    .aiClose{
      width:38px;height:38px;border-radius:12px;
      border:1px solid rgba(0,0,0,.10);
      background: rgba(255,255,255,.55);
      cursor:pointer;
      font-weight:900;
      color:#111827;
    }
    .aiChips{ padding:10px 14px; display:flex; flex-wrap:wrap; gap:8px; }
    .aiChips button{
      border:1px solid rgba(0,0,0,.10);
      background: rgba(0,0,0,.03);
      color:#111827;
      border-radius:999px;
      padding:8px 10px;
      font-weight:900;
      cursor:pointer;
      font-size:.92rem;
    }
    .aiMsgs{ padding: 4px 14px 12px; overflow:auto; flex:1; display:grid; gap:10px; }
    .aiMsg{ padding:10px 12px; border-radius:14px; border:1px solid rgba(0,0,0,.08); background: rgba(255,255,255,.70); color:#111827; line-height:1.35; }
    .aiMsg.me{ background: rgba(245,158,11,.10); border-color: rgba(245,158,11,.22); }
    .aiForm{ display:flex; gap:10px; padding: 12px 14px 14px; border-top:1px solid rgba(0,0,0,.08); }
    .aiInput{ flex:1; padding:12px; border-radius:12px; border:1px solid rgba(0,0,0,.12); background: rgba(0,0,0,.03); }
    .aiSend{ padding:12px 14px; border:none; border-radius:12px; font-weight:1000; cursor:pointer; background: linear-gradient(90deg, var(--accent1), var(--accent2)); color:#111827; }
    @media (max-width: 620px){
      .aiFab{ right:12px; bottom:12px; }
      .aiPanel{ left:12px; right:12px; width:auto; }
    }
</style>
</head>

<body>
  <div class="bg"></div>
  <div class="orb one"></div>
  <div class="orb two"></div>
  <div class="orb three"></div>
  <div class="sparkles"></div>

  <div class="page">
    <header>
      <div class="wrap">
        <h1>Karamelo</h1>
        <div class="subtitle">Plataforma profissional de edi√ß√£o de fotos e v√≠deos</div>
      </div>
    </header>

    <main>
      <div class="wrap">

        <!-- START -->
        <section id="screenStart" class="screen show">
          <div class="startPro">
            <div class="startCopy">
              <div class="startBadge">‚ú® 2026 ‚Ä¢ Karamelo</div>
              <h2 class="startTitle">Edi√ß√£o profissional de fotos e v√≠deos, com cara de premium.</h2>
              <p class="startDesc">Escolha um pacote pronto ou monte um personalizado. Ideal para Reels, TikTok, Shorts e fotos com acabamento profissional.</p>

              <div class="startChips" aria-label="Destaques">
                <span class="startChip">‚ö° Entrega a partir de <strong>13h30</strong></span>
                <span class="startChip">‚≠ê Avalia√ß√£o <strong>0‚Äì10</strong> (come√ßa em 5)</span>
                <span class="startChip">üîí CPF √∫nico (demo)</span>
              </div>

              <div class="startMini">
                <div class="miniCard">
                  <div class="miniIco">üéØ</div>
                  <div>
                    <div class="miniT">Pacotes prontos + Personalizado</div>
                    <div class="miniP">Voc√™ escolhe o que precisa. O site mostra s√≥ o total.</div>
                  </div>
                </div>
                <div class="miniCard">
                  <div class="miniIco">üß†</div>
                  <div>
                    <div class="miniT">Escolha do editor</div>
                    <div class="miniP">Veja editores compat√≠veis com seu pedido (demo).</div>
                  </div>
                </div>
                <div class="miniCard">
                  <div class="miniIco">‚ú®</div>
                  <div>
                    <div class="miniT">Visual consistente</div>
                    <div class="miniP">Cor cine, cortes, √°udio limpo e retoque avan√ßado.</div>
                  </div>
                </div>
              </div>

              <div class="startNote">* Sem backend nesta vers√£o: dados ficam salvos no navegador (LocalStorage).</div>
            </div>

            <div class="startRoles" aria-label="Escolha seu caminho">
              <div class="roleCardPro">
                <div class="roleTop">
                  <div class="roleIco">üõí</div>
                  <div>
                    <div class="roleT">Sou Cliente</div>
                    <div class="roleS">Crie seu perfil e escolha um pacote.</div>
                  </div>
                </div>
                <ul class="roleList">
                  <li>Pacotes prontos (15 op√ß√µes)</li>
                  <li>Personalizado com extras (√°udio, legenda, motion...)</li>
                  <li>Escolha do editor compat√≠vel</li>
                </ul>
                <button class="btn" type="button" onclick="openCadastro('cliente')">Criar conta (Cliente)</button>
              </div>

              <div class="roleCardPro">
                <div class="roleTop">
                  <div class="roleIco">üé¨</div>
                  <div>
                    <div class="roleT">Quero Trabalhar</div>
                    <div class="roleS">Cadastre-se como editor e selecione pacotes.</div>
                  </div>
                </div>
                <ul class="roleList">
                  <li>Ative ‚ÄúDispon√≠vel‚Äù para aparecer aos clientes</li>
                  <li>Escolha os pacotes que voc√™ aceita</li>
                  <li>Perfil com tags, bio e portf√≥lio</li>
                </ul>
                <button class="btn" type="button" onclick="openCadastro('editor')">Criar conta (Editor)</button>
              </div>
            </div>
          </div>
        </section>

        <!-- CLIENTE: PERFIL (ANTES DOS PACOTES) -->
        <section id="screenClientProfile" class="screen">
          <div class="section-title">Seu perfil (Cliente)</div>
          <div class="pill">Complete seu perfil para uma experi√™ncia melhor (come√ßa com 5 estrelas).</div>

          <div class="card" style="margin-top:12px">
            <div class="who">
              <div class="avatar" id="clientAvatarBox"></div>
              <div class="meta">
                <div style="font-weight:900" id="clientProfileName">Cliente</div>
                <div class="stars" id="clientStars"></div>
              </div>
            </div>

            <div class="uploadRow">
              <label class="btn secondary small" style="cursor:pointer">
                Enviar foto
                <input id="clientPhoto" type="file" accept="image/*" style="display:none">
              </label>
              <button class="btn secondary small" type="button" onclick="removeClientPhoto()">Remover</button>
              <div class="hint" style="margin-top:0">* Foto opcional (salva no navegador).</div>
            </div>

            <div class="mini-grid" style="margin-top:12px">
              <div class="mini">
                <label>WhatsApp</label>
                <input id="clWhats" placeholder="(DDD) 99999-9999" maxlength="15" inputmode="tel" />
              </div>
              <div class="mini">
                <label>Cidade</label>
                <input id="clCity" placeholder="Ex: S√£o Paulo - SP" maxlength="40" />
              </div>
            </div>

            <div class="mini-grid" style="margin-top:10px">
              <div class="mini">
                <label>Nicho / Categoria</label>
                <input id="clNiche" placeholder="Ex: Moda, Gaming, Fitness, Loja, Influencer..." maxlength="40" />
              </div>
              <div class="mini">
                <label>Rede principal</label>
                <select id="clMainPlatform">
                  <option value="instagram">Instagram</option>
                  <option value="tiktok">TikTok</option>
                  <option value="youtube">YouTube</option>
                  <option value="facebook">Facebook</option>
                  <option value="kwai">Kwai</option>
                  <option value="pinterest">Pinterest</option>
                  <option value="linkedin">LinkedIn</option>
                  <option value="x">X (Twitter)</option>
                </select>
              </div>
            </div>

            <div class="field" style="margin-top:10px">
              <label>Sobre voc√™ / Objetivo</label>
              <textarea id="clAbout" placeholder="Ex: Quero v√≠deos curtos para Reels/TikTok, estilo cinematogr√°fico, cortes r√°pidos, legendas..." maxlength="420"></textarea>
            </div>

            <div class="mini-grid" style="margin-top:12px">
              <button class="btn" type="button" onclick="saveClientProfileAndGo()">Salvar e continuar</button>
              <button class="btn secondary" type="button" onclick="goBackStart()">Voltar</button>
            </div>
          </div>
        </section>

        <!-- CLIENTE: PACOTES -->
        <section id="screenClient" class="screen">
          <div class="who">
            <div class="avatar" id="clientAvatarTop"></div>
            <div class="meta">
              <div class="section-title" style="margin:0">Bem-vindo, <span id="clientName">Cliente</span> üëã</div>
              <div class="stars" id="clientStarsTop"></div>
            </div>
          </div>

          <div class="pill" style="margin-top:10px">Escolha um pacote pronto ou monte um pacote personalizado.</div>

          <div class="section-title" style="margin-top:18px">Pacotes prontos (15 op√ß√µes)</div>
          <div id="packagesGrid" class="grid" style="margin-top:12px"></div>

          <div class="section-title" style="margin-top:26px">Pacote Personalizado ‚ú®</div>
          <div class="grid" style="margin-top:12px">
            <div class="card highlight full">
              <h3>Monte seu pacote</h3>
              <p>Escolha quantas fotos/v√≠deos voc√™ quer, plataforma e tipo de v√≠deo. O site soma tudo por tr√°s e mostra s√≥ o total.</p>

              <div class="mini-grid" style="margin-top:12px">
                <div class="mini">
                  <label>Fotos</label>
                  <input id="custFotos" type="number" min="0" value="0" max="999" inputmode="numeric" />
                </div>
                <div class="mini">
                  <label>V√≠deos</label>
                  <input id="custVideos" type="number" min="0" value="0" max="999" inputmode="numeric" />
                </div>
              </div>

              <div class="mini-grid" style="margin-top:10px">
                <div class="mini">
                  <label>Plataforma / Rede</label>
                  <select id="custPlataforma">
                    <option value="reels">Instagram Reels</option>
                    <option value="tiktok">TikTok</option>
                    <option value="insta">Instagram Feed</option>
                    <option value="shorts">YouTube Shorts</option>
                    <option value="ytlong">YouTube (v√≠deo normal)</option>
                    <option value="facebookreels">Facebook Reels</option>
                    <option value="kwai">Kwai</option>
                    <option value="snap">Snapchat Spotlight</option>
                    <option value="pinterest">Pinterest Idea Pins</option>
                    <option value="linkedin">LinkedIn</option>
                    <option value="x">X (Twitter)</option>
                  </select>
                </div>
                <div class="mini">
                  <label>Tipo de v√≠deo</label>
                  <select id="custTipoVideo">
                    <option value="15">Curto (at√© 15s)</option>
                    <option value="45">M√©dio (30‚Äì45s)</option>
                    <option value="60">Longo (at√© 60s)</option>
                  </select>
                </div>
              </div>

              <div class="checks" style="margin-top:10px" id="customChecks">
                <!-- principais (5) -->
                <div id="customOptsMain">
                  <label class="chk"><input data-custom-opt id="optCorCine" type="checkbox" /> Cor cinematogr√°fica (v√≠deos)</label>
                  <label class="chk"><input data-custom-opt id="optLegenda" type="checkbox" /> Legendas (v√≠deos)</label>
                  <label class="chk"><input data-custom-opt id="optTransicoes" type="checkbox" /> Transi√ß√µes premium (v√≠deos)</label>
                  <label class="chk"><input data-custom-opt id="optAudio" type="checkbox" /> Melhorar √°udio + reduzir ru√≠do (v√≠deos)</label>
                  <label class="chk"><input data-custom-opt id="optRetoquePro" type="checkbox" /> Retoque avan√ßado (fotos)</label>
                </div>

                <!-- mais op√ß√µes (colapsado) -->
                <div id="customOptsMore" class="collapsed">
                  <label class="chk"><input data-custom-opt id="optMotion" type="checkbox" /> Motion graphics (t√≠tulos) (v√≠deos)</label>
                  <label class="chk"><input data-custom-opt id="optIntroOutro" type="checkbox" /> Intro/Outro + CTA (v√≠deos)</label>
                  <label class="chk"><input data-custom-opt id="optEstabilizar" type="checkbox" /> Estabiliza√ß√£o (v√≠deos)</label>
                  <label class="chk"><input data-custom-opt id="optSpeedRamp" type="checkbox" /> Speed ramp / slow motion (v√≠deos)</label>

                  <label class="chk"><input data-custom-opt id="optSFX" type="checkbox" /> Efeitos sonoros (SFX) (v√≠deos)</label>
                  <label class="chk"><input data-custom-opt id="optMusicSync" type="checkbox" /> Sincronizar cortes com m√∫sica (v√≠deos)</label>
                  <label class="chk"><input data-custom-opt id="optVoiceClean" type="checkbox" /> Limpeza de voz / clareza (v√≠deos)</label>

                  <label class="chk"><input data-custom-opt id="optPele" type="checkbox" /> Suavizar pele (fotos)</label>
                  <label class="chk"><input data-custom-opt id="optFundo" type="checkbox" /> Remover/alterar fundo (fotos)</label>
                  <label class="chk"><input data-custom-opt id="optCoresFoto" type="checkbox" /> Cor cinematogr√°fica (fotos)</label>
                  <label class="chk"><input data-custom-opt id="optHDR" type="checkbox" /> HDR / nitidez premium (fotos)</label>
                  <label class="chk"><input data-custom-opt id="optObjeto" type="checkbox" /> Remover objetos (fotos)</label>
                  <label class="chk"><input data-custom-opt id="optTexto" type="checkbox" /> Texto/arte simples (fotos)</label>

                  <label class="chk"><input data-custom-opt id="optThumbnail" type="checkbox" /> Thumbnail (capa) (1 unidade)</label>
                  <label class="chk"><input data-custom-opt id="optUrgente" type="checkbox" /> Prioridade (entrega mais r√°pida)</label>
                </div>
              </div>

              <div class="moreRow">
                <button class="btn secondary small" id="toggleCustomOpts" type="button" onclick="toggleCustomOptions()">Ver mais op√ß√µes ‚Üì</button>
              </div>

              <div class="field" style="margin-top:12px">
                <label>Categoria detalhada</label>
                <textarea id="custDetalhe" placeholder="Descreva exatamente como voc√™ quer: estilo, refer√™ncia, cores, cortes, m√∫sicas, legendas, plataformas, etc..." maxlength="700"></textarea>
              </div>

              <div class="total-box">
                <div class="total-line"><span>Valor total</span><strong id="custTotal">R$ 0</strong></div>
                <div class="total-sub">Entrega estimada: <strong id="custEntrega">13h30</strong> (m√≠nimo)</div>
              </div>

              <button class="btn" type="button" onclick="confirmCustom()">Continuar com o personalizado</button>
              <div class="hint">* Os pre√ßos por item s√£o internos e n√£o aparecem.</div>
            </div>
          </div>

          <button class="btn secondary" style="margin-top:18px" type="button" onclick="goBackStart()">Voltar</button>
        </section>

        <!-- ‚úÖ Sele√ß√£o de Editor (Cliente) -->
        <section id="screenPickEditor" class="screen">
          <div class="section-title">Escolha seu Editor ‚≠ê</div>
          <div class="pill">Voc√™ ver√° editores compat√≠veis com o seu pedido (avalia√ß√£o come√ßa em 5 estrelas).</div>

          <div class="toolbar">
            <div class="left">
              <span class="chip" id="pickInfo">Pedido: ‚Äî</span>
              <span class="chip" id="pickRatingChip">Avalia√ß√£o: 5/10 ‚≠ê</span>
            </div>
            <div class="right">
              <select id="pickSort" style="min-width:240px">
                <option value="best">Melhores avaliados</option>
                <option value="fast">Mais r√°pidos (simulado)</option>
              </select>
            </div>
          </div>

          <div id="editorsGrid" class="editor-cards"></div>

          <button class="btn secondary" style="margin-top:18px" type="button" onclick="backToOrder()">Voltar</button>
        </section>

        <!-- ‚úÖ EDITOR DASHBOARD -->
        <section id="screenEditor" class="screen">
          <div class="section-title">Bem-vindo, <span id="editorName">Editor</span> üëã</div>
          <div class="pill">Complete seu perfil, selecione pacotes e fique dispon√≠vel para receber pedidos.</div>

          <div class="editor-grid">
            <!-- Perfil -->
            <div class="card">
              <div class="row-inline">
                <h3 style="margin:0;color:#c7d2fe">Seu perfil (Editor)</h3>

                <label class="switch" title="Aparecer para clientes">
                  <input id="edAvailable" type="checkbox" />
                  <span class="track"><span class="thumb"></span></span>
                  <span>
                    <div class="label">Dispon√≠vel</div>
                    <div class="sub" id="edAvailText">Off</div>
                  </span>
                </label>
              </div>

              <div class="who" style="margin-top:12px">
                <div class="avatar" id="editorAvatarBox"></div>
                <div class="meta">
                  <div style="font-weight:900" id="editorFullName">Editor</div>
                  <div class="stars" id="editorStars"></div>
                </div>
              </div>

              <div class="uploadRow">
                <label class="btn secondary small" style="cursor:pointer">
                  Enviar foto
                  <input id="editorPhoto" type="file" accept="image/*" style="display:none">
                </label>
                <button class="btn secondary small" type="button" onclick="removeEditorPhoto()">Remover</button>
                <div class="hint" style="margin-top:0">* Foto opcional (salva no navegador).</div>
              </div>

              <!-- KPIs √∫teis (sem comiss√£o/admin aqui) -->
              <div class="kpi">
                <div class="k">
                  <div class="t">Avalia√ß√£o</div>
                  <div class="v"><span id="edRatingTxt">5.0</span><small>/10</small></div>
                  <div class="stars" id="edStarsRow" style="margin-top:6px"></div>
                </div>
                <div class="k">
                  <div class="t">Conclu√≠dos</div>
                  <div class="v"><span id="edDone">0</span><small> pedidos</small></div>
                </div>
                <div class="k">
                  <div class="t">Status</div>
                  <div class="v"><span id="edStatus">Novo</span></div>
                </div>
              </div>

              <div class="mini-grid" style="margin-top:12px">
                <div class="mini">
                  <label>Experi√™ncia</label>
                  <select id="edXp">
                    <option value="iniciante">Iniciante</option>
                    <option value="intermediario">Intermedi√°rio</option>
                    <option value="avancado">Avan√ßado</option>
                  </select>
                </div>
                <div class="mini">
                  <label>WhatsApp (opcional)</label>
                  <input id="edWhats" placeholder="(DDD) 99999-9999" maxlength="15" inputmode="tel" />
                </div>
              </div>

              <div class="field" style="margin-top:10px">
                <label>Bio (curta e forte)</label>
                <textarea id="edBio" placeholder="Ex: cortes r√°pidos + cor cinematogr√°fica + √°udio limpo. Especialista em Reels e TikTok." maxlength="320"></textarea>
              </div>

              <div class="mini-grid" style="margin-top:10px">
                <div class="mini">
                  <label>Softwares</label>
                  <input id="edSoft" placeholder="CapCut, Premiere, Lightroom..." maxlength="80" />
                </div>
                <div class="mini">
                  <label>Portf√≥lio (link)</label>
                  <input id="edPortfolio" placeholder="https://..." maxlength="120" inputmode="url" />
                </div>
              </div>

              <div class="field" style="margin-top:10px">
                <label>Tags (separe por v√≠rgula)</label>
                <input id="edTags" placeholder="Reels, TikTok, Motion, Cor cine, Foto pro, √Åudio..." maxlength="120" />
                <div id="edTagsPreview" class="tags"></div>
              </div>

              <div class="mini-grid" style="margin-top:12px">
                <button class="btn" type="button" onclick="saveEditorProfile()">Salvar perfil</button>
                <button class="btn secondary" type="button" onclick="resetEditor()">Reset (demo)</button>
              </div>

              <!-- Preview p√∫blico (movido para cima) -->
              <div class="section-title" style="margin:18px 0 8px">Como voc√™ aparece para o cliente</div>
              <div class="pill" style="margin:0 0 10px">Esse √© o card que vai aparecer na tela de escolha do editor.</div>
              <div class="editor-cards" style="margin-top:10px">
                <div class="eCard" id="edPublicPreview"></div>
              </div>

              <div class="hint">
                * Comiss√£o √© fixa e s√≥ aparece no painel ADM no futuro (Karamelo 25% / Editor 75%).
              </div>
            </div>

            <!-- Pacotes -->
            <div class="card">
              <h3>Pacotes que voc√™ quer trabalhar</h3>
              <p>Marque os pacotes que voc√™ aceita. Assim voc√™ s√≥ aparece em pedidos compat√≠veis.</p>

              <div class="mini-grid" style="margin-top:10px">
                <div class="mini">
                  <label>Buscar pacote</label>
                  <input id="edSearchPkg" placeholder="Ex: Foto, Short, 45s..." maxlength="40" />
                </div>
                <div class="mini">
                  <label>Atalhos</label>
                  <select id="edQuick">
                    <option value="all">‚Äî</option>
                    <option value="video">S√≥ V√≠deo</option>
                    <option value="foto">S√≥ Foto</option>
                    <option value="mix">Mix (Foto + V√≠deo)</option>
                    <option value="audio">√Åudio</option>
                  </select>
                </div>
              </div>

              <div id="editorPackages" class="pkg-list"></div>

              <!-- ‚úÖ BOT√ÉO SETA: mostra s√≥ 5 e abre o resto -->
              <div class="moreRow">
                <button class="btn secondary small" id="toggleMorePkgs" type="button" onclick="toggleMorePackages()">
                  Ver mais pacotes ‚Üì
                </button>
              </div>

              <div class="total-box" style="margin-top:12px">
                <div class="total-line">
                  <span>Selecionados</span>
                  <strong id="edPkgCount">0</strong>
                </div>
                <div class="total-sub" id="edPkgHint">Dica: selecione pelo menos 1 pacote para aparecer para clientes.</div>
              </div>

              <div class="mini-grid" style="margin-top:12px">
                <button class="btn" type="button" onclick="saveEditorPackages()">Salvar pacotes</button>
                <button class="btn secondary" type="button" onclick="selectAllEditorPackages(true)">Marcar todos</button>
              </div>
              <button class="btn secondary" type="button" onclick="selectAllEditorPackages(false)" style="margin-top:10px">Desmarcar todos</button>

              <div class="hint">* Sem backend: isso √© salvo no seu navegador (LocalStorage).</div>
            </div>
          </div>

              <!-- Portf√≥lio do Editor (demo) -->
              <div class="section-title" style="margin:18px 0 8px">Portf√≥lio (trabalhos)</div>
              <div class="pill" style="margin:0 0 10px">Carregue at√© <strong>30 fotos</strong> e <strong>10 v√≠deos</strong> para mostrar aos clientes (demo: n√£o salva no navegador).</div>

              <div class="mini-grid" style="margin-top:10px">
                <label class="btn secondary small" style="cursor:pointer; display:flex; align-items:center; justify-content:center; gap:8px">
                  Enviar fotos (at√© 30)
                  <input id="edWorkPhotos" type="file" accept="image/*" multiple style="display:none" />
                </label>
                <label class="btn secondary small" style="cursor:pointer; display:flex; align-items:center; justify-content:center; gap:8px">
                  Enviar v√≠deos (at√© 10)
                  <input id="edWorkVideos" type="file" accept="video/*" multiple style="display:none" />
                </label>
              </div>
              <div class="hint" id="edWorkCount" style="margin-top:10px">0/30 fotos ‚Ä¢ 0/10 v√≠deos</div>
              <div id="edWorkGrid" class="work-grid"></div>
              <button class="btn secondary small" type="button" style="margin-top:10px" onclick="clearEditorWorks()">Limpar portf√≥lio</button>


          <button class="btn secondary" style="margin-top:18px" type="button" onclick="goBackStart()">Voltar</button>
        </section>

      </div>
    </main>

    <footer>¬© 2026 ‚Ä¢ Karamelo ‚Ä¢ Edi√ß√£o profissional</footer>
  </div>

  <!-- MODAL CADASTRO -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <div id="modal" class="modal" role="dialog" aria-modal="true">
      <div class="modalHead">
        <strong id="titleCadastro">Criar conta</strong>
        <button class="close" type="button" onclick="closeCadastro()">√ó</button>
      </div>
      <div class="modalBody">
        <div class="authWrap" id="authWrap">
          <!-- Cadastro -->
          <div class="authView active" data-view="register" id="viewRegister">
            <div class="field"><label>Nome</label><input id="inNome" placeholder="Seu nome" maxlength="30" autocomplete="given-name" /></div>
            <div class="field"><label>Sobrenome</label><input id="inSobrenome" placeholder="Seu sobrenome" maxlength="30" autocomplete="family-name" /></div>
            <div class="field"><label>Data de nascimento</label><input id="inData" type="date" /></div>
            <div class="field"><label>CPF</label><input id="inCPF" inputmode="numeric" placeholder="000.000.000-00" maxlength="14" autocomplete="off" /></div>
            <div class="field"><label>Email</label><input id="inEmail" type="email" placeholder="seuemail@gmail.com" maxlength="80" autocomplete="email" /></div>
            <div class="field"><label>Senha</label><input id="inSenha" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="32" autocomplete="new-password" /></div>

            <div class="authLinks">
              <button class="linkBtn" type="button" id="toLogin">J√° tenho conta</button>
            </div>

            <button id="btnCadastrar" class="btn" type="button">Continuar</button>
            <button class="btn secondary" type="button" onclick="alert('Entrar com Google: em breve (precisa backend).')">Entrar com Google (em breve)</button>
            <div class="hint">* Login real com Google e seguran√ßa total entram na etapa futura (backend).</div>
          </div>

          <!-- Login -->
          <div class="authView" data-view="login" id="viewLogin">
            <div class="field"><label>Email</label><input id="loginEmail" type="email" placeholder="seuemail@gmail.com" maxlength="80" autocomplete="email" /></div>
            <div class="field"><label>Senha</label><input id="loginSenha" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="32" autocomplete="current-password" /></div>

            <div class="authLinks" style="margin-top:6px">
              <button class="linkBtn" type="button" id="toRegister">N√£o tenho conta</button>
            </div>

            <button id="btnLogin" class="btn" type="button">Entrar</button>
            <div class="hint">* Demo sem backend: login valida os dados salvos neste navegador.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- IA Karamelo (demo local) -->
  <button class="aiFab" id="aiFab" aria-label="Abrir IA Karamelo">
    <span class="dot" aria-hidden="true"></span>
    <span>IA</span>
  </button>

  <section class="aiPanel" id="aiPanel" aria-hidden="true">
    <div class="aiHead">
      <div>
        <div class="aiTitle">IA Karamelo</div>
        <div class="aiSub" id="aiSub">Ajuda para Cliente, Editor e novos usu√°rios</div>
      </div>
      <button class="aiClose" id="aiClose" type="button" aria-label="Fechar">√ó</button>
    </div>
    <div class="aiChips" id="aiChips">
      <button type="button" data-ai="novo">Primeiros passos</button>
      <button type="button" data-ai="cliente">Sou Cliente</button>
      <button type="button" data-ai="editor">Sou Editor</button>
      <button type="button" data-ai="pacotes">Sugest√£o de pacotes</button>
      <button type="button" data-ai="bio">Bio/Tags</button>
    </div>
    <div class="aiMsgs" id="aiMsgs" aria-live="polite"></div>
    <form class="aiForm" id="aiForm">
      <input class="aiInput" id="aiInput" placeholder="Pergunte algo..." autocomplete="off" />
      <button class="aiSend" type="submit">Enviar</button>
    </form>
  </section>

  <script>
    // ===== Util =====
    const MAX_STARS = 10;
    const START_STARS = 5.0;

    function escapeHtml(str){
      return String(str ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }
    function brl(v){ return Number(v||0).toLocaleString('pt-BR', {style:'currency', currency:'BRL'}); }

    function renderStarsHTML(value, max=MAX_STARS){
      const v = Math.max(0, Math.min(max, Number(value||0)));
      const full = Math.round(v);
      let html = "";
      for(let i=0;i<full;i++) html += `<span class="star">‚òÖ</span>`;
      for(let i=full;i<max;i++) html += `<span class="star off">‚òÖ</span>`;
      html += `<small>${v.toFixed(1)}/${max}</small>`;
      return html;
    }

    function setAvatar(el, photoDataUrl, fallbackText){
      if(!el) return;
      el.innerHTML = "";
      if(photoDataUrl){
        const img = document.createElement("img");
        img.src = photoDataUrl;
        el.appendChild(img);
      }else{
        el.textContent = (fallbackText || "K").slice(0,1).toUpperCase();
      }
    }

    function readFileAsDataURL(file){
      return new Promise((resolve, reject)=>{
        const r = new FileReader();
        r.onload = () => resolve(String(r.result||""));
        r.onerror = reject;
        r.readAsDataURL(file);
      });
    }

    function lsGet(key, fallback){
      try{
        const raw = localStorage.getItem(key);
        if(!raw) return fallback;
        return JSON.parse(raw);
      }catch(e){ return fallback; }
    }
    function lsSet(key, value){
      try{ localStorage.setItem(key, JSON.stringify(value)); }catch(e){}
    }

    // ===== Base (screens) =====
    const overlay = document.getElementById('overlay');
    const modal = document.getElementById('modal');
    const titleCadastro = document.getElementById('titleCadastro');
    const btnCadastrar = document.getElementById('btnCadastrar');

    const screenStart = document.getElementById('screenStart');
    const screenClientProfile = document.getElementById('screenClientProfile');
    const screenClient = document.getElementById('screenClient');
    const screenPickEditor = document.getElementById('screenPickEditor');
    const screenEditor = document.getElementById('screenEditor');

    const inNome = document.getElementById('inNome');
    const inSobrenome = document.getElementById('inSobrenome');

    const clientName = document.getElementById('clientName');
    const editorName = document.getElementById('editorName');

    let role = null;
    let currentOrder = null;

    // ===== Auth modal (Cadastro/Login) =====
    const authWrap = document.getElementById('authWrap');
    const viewRegister = document.getElementById('viewRegister');
    const viewLogin = document.getElementById('viewLogin');
    const toLogin = document.getElementById('toLogin');
    const toRegister = document.getElementById('toRegister');
    const btnLogin = document.getElementById('btnLogin');

    const inData = document.getElementById('inData');
    const inCPF = document.getElementById('inCPF');
    const inEmail = document.getElementById('inEmail');
    const inSenha = document.getElementById('inSenha');

    const loginEmail = document.getElementById('loginEmail');
    const loginSenha = document.getElementById('loginSenha');

    let authMode = 'register';

    function updateAuthTitle(){
      titleCadastro.textContent = (authMode === 'register')
        ? ((role === 'cliente') ? 'Criar conta como Cliente' : 'Criar conta como Editor')
        : ((role === 'cliente') ? 'Entrar como Cliente' : 'Entrar como Editor');
    }

    // garante que o conte√∫do do cadastro/login n√£o fique ‚Äúcortado‚Äù (PC e celular)
    function syncAuthWrapHeight(){
      if(!authWrap) return;
      const active = (authMode === 'register') ? viewRegister : viewLogin;
      if(!active) return;
      authWrap.style.height = `${active.scrollHeight}px`;
    }

    let switchingAuth = false;

    function setAuthMode(mode, animate=true){
      if(!authWrap || mode === authMode || switchingAuth) return;

      const from = (authMode === 'register') ? viewRegister : viewLogin;
      const to   = (mode === 'register') ? viewRegister : viewLogin;
      if(!from || !to) { authMode = mode; updateAuthTitle(); return; }

      switchingAuth = true;

      // limpa classes de anima√ß√£o anteriores
      [from, to].forEach(el=>{
        el.classList.remove('enterLeft','enterRight','leaveLeft','leaveRight','enter-left','enter-right','leave-left','leave-right');
        el.style.zIndex = '';
      });

      // ativa destino e garante stacking correto
      to.classList.add('active');
      to.style.zIndex = '3';
      from.style.zIndex = '2';

      if(!animate){
        from.classList.remove('active');
        authMode = mode;
        updateAuthTitle();
        syncAuthWrapHeight();
        switchingAuth = false;
        return;
      }

      const toLoginDir = (mode === 'login');

      // for√ßa reflow pra anima√ß√£o N√ÉO ‚Äúpular‚Äù
      void to.offsetWidth;

      requestAnimationFrame(()=>{
        // usa os nomes novos (Left/Right) mas tamb√©m funciona com CSS anterior
        from.classList.add(toLoginDir ? 'leaveLeft' : 'leaveRight');
        to.classList.add(toLoginDir ? 'enterRight' : 'enterLeft');
      });

      authMode = mode;
      updateAuthTitle();

      setTimeout(()=>{
        from.classList.remove('active','leaveLeft','leaveRight');
        to.classList.remove('enterLeft','enterRight');
        from.style.zIndex = '';
        to.style.zIndex = '';
        syncAuthWrapHeight();
        switchingAuth = false;
      }, 380);
    }


    function resetAuthUI(){
      switchingAuth = false;
      authMode = 'register';

      viewRegister?.classList.add('active');
      viewLogin?.classList.remove('active');

      [viewRegister, viewLogin].forEach(el=>{
        el?.classList.remove('enterLeft','enterRight','leaveLeft','leaveRight','enter-left','enter-right','leave-left','leave-right');
        if(el) el.style.zIndex = '';
      });

      updateAuthTitle();
      syncAuthWrapHeight();
    }


    toLogin?.addEventListener('click', ()=> setAuthMode('login', true));
    toRegister?.addEventListener('click', ()=> setAuthMode('register', true));

    // ===== CPF / Idade (demo) =====
    function cpfDigits(v){ return String(v||'').replace(/\D/g,'').slice(0,11); }
    function formatCPF(d){
      d = cpfDigits(d);
      if(d.length<=3) return d;
      if(d.length<=6) return d.slice(0,3)+'.'+d.slice(3);
      if(d.length<=9) return d.slice(0,3)+'.'+d.slice(3,6)+'.'+d.slice(6);
      return d.slice(0,3)+'.'+d.slice(3,6)+'.'+d.slice(6,9)+'-'+d.slice(9);
    }
    function isValidCPF(cpf){
      const d = cpfDigits(cpf);
      if(d.length !== 11) return false;
      if(/^([0-9])\1+$/.test(d)) return false;
      let sum=0; for(let i=0;i<9;i++) sum += parseInt(d.charAt(i),10)*(10-i);
      let check = 11 - (sum % 11); if(check>=10) check=0;
      if(check !== parseInt(d.charAt(9),10)) return false;
      sum=0; for(let i=0;i<10;i++) sum += parseInt(d.charAt(i),10)*(11-i);
      check = 11 - (sum % 11); if(check>=10) check=0;
      return check === parseInt(d.charAt(10),10);
    }
    function calcAge(isoDate){
      if(!isoDate) return NaN;
      const b = new Date(isoDate);
      if(isNaN(b.getTime())) return NaN;
      const n = new Date();
      let age = n.getFullYear() - b.getFullYear();
      const m = n.getMonth() - b.getMonth();
      if(m < 0 || (m===0 && n.getDate() < b.getDate())) age--;
      return age;
    }

    if(inCPF){
      inCPF.addEventListener('input', ()=>{
        const d = cpfDigits(inCPF.value);
        inCPF.value = formatCPF(d);
      });
    }


    function openCadastro(tipo){
      role = tipo;
      resetAuthUI();

      // limpa campos (para nao misturar cadastros)
      if(inNome) inNome.value = '';
      if(inSobrenome) inSobrenome.value = '';
      if(inData) inData.value = '';
      if(inCPF) inCPF.value = '';
      if(inEmail) inEmail.value = '';
      if(inSenha) inSenha.value = '';
      if(loginEmail) loginEmail.value = '';
      if(loginSenha) loginSenha.value = '';

      overlay.classList.remove('closing');
      modal.classList.remove('closing');
      overlay.classList.add('show');
      overlay.setAttribute('aria-hidden','false');
      modal.style.animation = 'none'; void modal.offsetHeight; modal.style.animation = '';
      requestAnimationFrame(syncAuthWrapHeight);
    }
    function closeCadastro(){
      overlay.classList.add('closing');
      modal.classList.add('closing');
      setTimeout(() => {
        overlay.classList.remove('show','closing');
        modal.classList.remove('closing');
        overlay.setAttribute('aria-hidden','true');
      }, 220);
    }
    overlay.addEventListener('click', (e) => { if(e.target === overlay) closeCadastro(); });
    window.addEventListener('resize', ()=>{
      if(overlay?.classList.contains('show')) syncAuthWrapHeight();
    });

    function showScreen(which){
      [screenStart, screenClientProfile, screenClient, screenPickEditor, screenEditor].forEach(s => s.classList.remove('show'));
      setTimeout(() => {
        which.classList.add('show');
        window.scrollTo({top:0, behavior:'smooth'});
      }, 50);
    }
    function goBackStart(){ showScreen(screenStart); }

    // ===== Storage =====
    const LS_EDITOR = "karamello_editor_v6";
    const LS_CLIENT = "karamello_client_v2";

    const LS_ACCOUNTS = "karamello_accounts_v1";

    function normEmail(v){ return String(v||"").trim().toLowerCase(); }
    function roleKey(){ return (role === "cliente") ? "client" : "editor"; }
    function getAccounts(){ return lsGet(LS_ACCOUNTS, { client:{}, editor:{} }); }
    function setAccounts(obj){ lsSet(LS_ACCOUNTS, obj); }
    function findEmailByCPF(kind, cpfD){
      const acc = getAccounts();
      const m = acc?.[kind] || {};
      for(const k of Object.keys(m)){
        if(String(m[k]?.cpf||"") === String(cpfD)) return k;
      }
      return null;
    }

    

    // ===== Pacotes =====
    const packages = [
      {id:1,  name:'Starter Foto',     price:27.40, eta:'13h30', items:['1 Foto (b√°sica)','Cor + nitidez']},
      {id:2,  name:'Duo Foto',         price:41.80, eta:'13h30', items:['2 Fotos (b√°sicas)','Cor + nitidez']},
      {id:3,  name:'Foto Pro 3',       price:53.60, eta:'14h30', items:['3 Fotos (pro)','Ajustes finos + cor']},
      {id:4,  name:'V√≠deo Short 15s',  price:63.90, eta:'14h30', items:['1 V√≠deo curto (at√© 15s)','Cortes + ritmo']},
      {id:5,  name:'Foto Pack 4',      price:73.50, eta:'15h00', items:['4 Fotos (pro)','Cor + detalhes']},
      {id:6,  name:'Short Duo',        price:86.40, eta:'15h30', items:['2 V√≠deos curtos (at√© 15s)','Cortes + transi√ß√µes simples']},
      {id:7,  name:'Combo Social',     price:96.80, eta:'16h00', items:['1 Foto + 1 V√≠deo curto','Look cinematogr√°fico leve']},
      {id:8,  name:'Foto Pack 5',      price:108.90,eta:'18h00', items:['5 Fotos (pro)','Padroniza√ß√£o de cor']},
      {id:9,  name:'Short Trio',       price:132.70,eta:'18h00', items:['3 V√≠deos curtos (at√© 15s)','Cor + ritmo']},
      {id:10, name:'Foto Pack 8',      price:151.40,eta:'24h',   items:['8 Fotos (pro)','Cor + retoques leves']},
      {id:11, name:'Short 5',          price:176.90,eta:'24h',   items:['5 V√≠deos curtos','Cortes + cor']},
      {id:12, name:'Creator Mix',      price:197.80,eta:'24h',   items:['10 Fotos + 1 V√≠deo curto','Padroniza√ß√£o completa']},
      {id:13, name:'V√≠deo M√©dio 45s',  price:221.60,eta:'24h',   items:['1 V√≠deo m√©dio (30‚Äì45s)','Cor + transi√ß√µes']},
      {id:14, name:'V√≠deo Longo 60s',  price:259.40,eta:'48h',   items:['1 V√≠deo longo (at√© 60s)','Edi√ß√£o avan√ßada']},
      {id:15, name:'Premium Creator',  price:329.90,eta:'48h',   items:['15 Fotos + 3 V√≠deos curtos','Look premium + revis√£o']},
    ];

    function renderPackages(){
      const grid = document.getElementById('packagesGrid');
      if(!grid) return;
      grid.innerHTML = '';
      packages.forEach(p => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <h3>${p.id}. ${escapeHtml(p.name)}</h3>
          <p>Entrega a partir de <strong>${escapeHtml(p.eta)}</strong> (m√≠nimo 13h30)</p>
          <div class="price">${brl(p.price)}</div>
          <ul>${p.items.map(i=>`<li>${escapeHtml(i)}</li>`).join('')}</ul>
          <button class="btn" type="button" onclick="choosePackage(${p.id})">Escolher pacote</button>
        `;
        grid.appendChild(card);
      });
    }

    // ===== CLIENTE (perfil) =====
    const clientAvatarBox = document.getElementById('clientAvatarBox');
    const clientAvatarTop = document.getElementById('clientAvatarTop');
    const clientProfileName = document.getElementById('clientProfileName');
    const clientStars = document.getElementById('clientStars');
    const clientStarsTop = document.getElementById('clientStarsTop');

    const clientPhoto = document.getElementById('clientPhoto');
    const clWhats = document.getElementById('clWhats');
    const clCity = document.getElementById('clCity');
    const clNiche = document.getElementById('clNiche');
    const clMainPlatform = document.getElementById('clMainPlatform');
    const clAbout = document.getElementById('clAbout');

    let clientData = lsGet(LS_CLIENT, null);

    function ensureClientData(nome, sobrenome){
      const full = `${nome} ${sobrenome}`.trim();
      clientData = clientData || {
        first:nome||'Cliente',
        last:sobrenome||'',
        full: full || 'Cliente',
        stars: START_STARS,
        photo:'',
        whats:'',
        city:'',
        niche:'',
        mainPlatform:'instagram',
        about:'',
        cpf:'',
        email:'',
        dob:''
      };
      clientData.first = nome || clientData.first;
      clientData.last = sobrenome || clientData.last;
      clientData.full = full || clientData.full;
      clientData.stars = START_STARS;
      lsSet(LS_CLIENT, clientData);
    }

    function paintClientProfile(){
      if(clientProfileName) clientProfileName.textContent = clientData?.full || 'Cliente';
      if(clientStars) clientStars.innerHTML = renderStarsHTML(clientData?.stars ?? START_STARS, MAX_STARS);
      setAvatar(clientAvatarBox, clientData?.photo, (clientData?.full||'C')[0]);
      if(clWhats) clWhats.value = clientData?.whats || '';
      if(clCity) clCity.value = clientData?.city || '';
      if(clNiche) clNiche.value = clientData?.niche || '';
      if(clMainPlatform) clMainPlatform.value = clientData?.mainPlatform || 'instagram';
      if(clAbout) clAbout.value = clientData?.about || '';
    }

    function paintClientTop(){
      if(clientName) clientName.textContent = clientData?.first || 'Cliente';
      if(clientStarsTop) clientStarsTop.innerHTML = renderStarsHTML(clientData?.stars ?? START_STARS, MAX_STARS);
      setAvatar(clientAvatarTop, clientData?.photo, (clientData?.full||'C')[0]);
    }

    clientPhoto?.addEventListener('change', async (e)=>{
      const file = e.target.files?.[0];
      if(!file || !clientData) return;
      const data = await readFileAsDataURL(file);
      clientData.photo = data;
      lsSet(LS_CLIENT, clientData);
      paintClientProfile();
      paintClientTop();
    });

    function removeClientPhoto(){
      if(!clientData) return;
      clientData.photo = '';
      lsSet(LS_CLIENT, clientData);
      paintClientProfile();
      paintClientTop();
    }

    function saveClientProfileAndGo(){
      if(!clientData) clientData = {first:'Cliente', last:'', full:'Cliente', stars:START_STARS};
      clientData.whats = (clWhats?.value||'').trim();
      clientData.city = (clCity?.value||'').trim();
      clientData.niche = (clNiche?.value||'').trim();
      clientData.mainPlatform = clMainPlatform?.value || 'instagram';
      clientData.about = (clAbout?.value||'').trim();
      clientData.stars = START_STARS;
      lsSet(LS_CLIENT, clientData);
      paintClientTop();
      showScreen(screenClient);
      setTimeout(()=>{ renderPackages(); calcCustom(); }, 80);
    }

    // ===== CUSTOM (Cliente) =====
    const custFotos = document.getElementById('custFotos');
    const custVideos = document.getElementById('custVideos');
    const custPlataforma = document.getElementById('custPlataforma');
    const custTipoVideo = document.getElementById('custTipoVideo');
    const custTotal = document.getElementById('custTotal');
    const custEntrega = document.getElementById('custEntrega');

    const PRICES = {
      foto: 21.40,
      video15: 44.90,
      video45: 66.70,
      video60: 84.60,
      platformMult: {
        reels:1.00, tiktok:1.00, insta:1.04, shorts:1.04,
        ytlong:1.06, facebookreels:1.02, kwai:1.00, snap:1.02,
        pinterest:1.02, linkedin:1.03, x:1.02
      }
    };

    const EXTRA_OPTIONS = [
      { id:'optCorCine',    kind:'video', price:11.60 },
      { id:'optLegenda',    kind:'video', price:11.60 },
      { id:'optTransicoes', kind:'video', price:9.40  },
      { id:'optMotion',     kind:'video', price:11.60 },
      { id:'optIntroOutro', kind:'video', price:11.60 },
      { id:'optEstabilizar',kind:'video', price:11.60 },
      { id:'optSpeedRamp',  kind:'video', price:9.40  },

      { id:'optSFX',        kind:'video', price:9.40  },
      { id:'optAudio',      kind:'video', price:11.60 },
      { id:'optMusicSync',  kind:'video', price:9.90  },
      { id:'optVoiceClean', kind:'video', price:11.90 },

      { id:'optRetoquePro', kind:'photo', price:9.40  },
      { id:'optPele',       kind:'photo', price:9.40  },
      { id:'optFundo',      kind:'photo', price:11.60 },
      { id:'optCoresFoto',  kind:'photo', price:9.40  },
      { id:'optHDR',        kind:'photo', price:9.40  },
      { id:'optObjeto',     kind:'photo', price:11.60 },
      { id:'optTexto',      kind:'photo', price:9.40  },

      { id:'optThumbnail',  kind:'order', price:19.90 },
      { id:'optUrgente',    kind:'order', price:29.90 },
    ];

    function calcEntrega(total, urgent){
      let eta = '13h30';
      if(total <= 120) eta = '13h30';
      else if(total <= 250) eta = '14h30';
      else if(total <= 400) eta = '18h00';
      else if(total <= 700) eta = '24h';
      else eta = '48h';

      if(urgent){
        if(eta === '48h') eta = '24h';
        else if(eta === '24h') eta = '18h00';
        else if(eta === '18h00') eta = '14h30';
        else eta = '13h30';
      }
      return eta;
    }

    function calcCustom(){
      const maxN = 999;
      const fotos = Math.min(maxN, Math.max(0, parseInt(custFotos?.value||'0',10) || 0));
      const vids  = Math.min(maxN, Math.max(0, parseInt(custVideos?.value||'0',10) || 0));
      if(custFotos) custFotos.value = String(fotos);
      if(custVideos) custVideos.value = String(vids);
      const plat  = custPlataforma?.value||'reels';
      const tipo  = custTipoVideo?.value||'15';

      let unitVideo = PRICES.video15;
      if(tipo==='45') unitVideo = PRICES.video45;
      if(tipo==='60') unitVideo = PRICES.video60;

      const mult = PRICES.platformMult[plat] ?? 1.0;

      let extraVideo=0, extraPhoto=0, extraOrder=0;
      EXTRA_OPTIONS.forEach(o=>{
        const el=document.getElementById(o.id);
        if(!el||!el.checked) return;
        if(o.kind==='video') extraVideo+=o.price;
        else if(o.kind==='photo') extraPhoto+=o.price;
        else extraOrder+=o.price;
      });

      const rawTotal = (fotos*(PRICES.foto+extraPhoto)) + (vids*(unitVideo*mult+extraVideo)) + extraOrder;
      const jitter = (fotos+vids)>0 ? (0.30 + ((fotos*7 + vids*11)%7)*0.10) : 0;
      const total = Math.max(0, rawTotal + jitter);

      if(custTotal) custTotal.textContent = brl(total);
      const urgent = document.getElementById('optUrgente')?.checked || false;
      if(custEntrega) custEntrega.textContent = calcEntrega(total, urgent);
    }

    [custFotos,custVideos,custPlataforma,custTipoVideo].forEach(el=>{
      if(!el) return;
      el.addEventListener('input', calcCustom);
      el.addEventListener('change', calcCustom);
    });
    Array.from(document.querySelectorAll('[data-custom-opt]')).forEach(el=>{
      el.addEventListener('change', calcCustom);
    });

    // ===== UI: Personalizado (5 principais + setinha) =====
    let showAllCustomOptions = false;
    function toggleCustomOptions(){
      showAllCustomOptions = !showAllCustomOptions;
      const more = document.getElementById('customOptsMore');
      const btn  = document.getElementById('toggleCustomOpts');
      if(more) more.classList.toggle('collapsed', !showAllCustomOptions);
      if(btn) btn.textContent = showAllCustomOptions ? 'Mostrar menos ‚Üë' : 'Ver mais op√ß√µes ‚Üì';
    }

    // ===== Pedido -> Escolher Editor =====
    function choosePackage(id){
      const p = packages.find(x => x.id === id);
      if(!p) return;
      currentOrder = {
        kind: 'package',
        packageId: p.id,
        title: `${p.id}. ${p.name}`,
        total: p.price,
        eta: p.eta
      };
      startPickEditor();
    }

    function confirmCustom(){
      currentOrder = {
        kind: 'custom',
        title: 'Pacote Personalizado',
        totalText: custTotal?.textContent || brl(0),
        eta: custEntrega?.textContent || '13h30',
        fotos: parseInt(custFotos?.value||'0',10),
        videos: parseInt(custVideos?.value||'0',10)
      };
      startPickEditor();
    }

    function startPickEditor(){
      const pickInfo = document.getElementById('pickInfo');
      const pickRatingChip = document.getElementById('pickRatingChip');
      if(pickRatingChip) pickRatingChip.textContent = `Avalia√ß√£o: ${START_STARS.toFixed(0)}/${MAX_STARS} ‚≠ê`;

      if(currentOrder?.kind === 'package'){
        if(pickInfo) pickInfo.textContent = `Pedido: ${currentOrder.title} ‚Ä¢ ${brl(currentOrder.total)} ‚Ä¢ ${currentOrder.eta}`;
      }else{
        if(pickInfo) pickInfo.textContent = `Pedido: Personalizado ‚Ä¢ ${currentOrder.totalText} ‚Ä¢ ${currentOrder.eta}`;
      }
      renderPickEditors();
      showScreen(screenPickEditor);
    }

    function backToOrder(){ showScreen(screenClient); }

    // ===== EDITOR (dashboard) =====
    const editorAvatarBox = document.getElementById('editorAvatarBox');
    const editorFullName = document.getElementById('editorFullName');
    const editorStars = document.getElementById('editorStars');

    const editorPhoto = document.getElementById('editorPhoto');
    const edAvailable = document.getElementById('edAvailable');
    const edAvailText = document.getElementById('edAvailText');

    const edRatingTxt = document.getElementById('edRatingTxt');
    const edStarsRow = document.getElementById('edStarsRow');
    const edDone = document.getElementById('edDone');
    const edStatus = document.getElementById('edStatus');

    const edXp = document.getElementById('edXp');
    const edWhats = document.getElementById('edWhats');
    const edBio = document.getElementById('edBio');
    const edSoft = document.getElementById('edSoft');
    const edPortfolio = document.getElementById('edPortfolio');
    const edTags = document.getElementById('edTags');
    const edTagsPreview = document.getElementById('edTagsPreview');

    const edSearchPkg = document.getElementById('edSearchPkg');
    const edQuick = document.getElementById('edQuick');
    const edPkgCount = document.getElementById('edPkgCount');
    const edPkgHint = document.getElementById('edPkgHint');
    const edPublicPreview = document.getElementById('edPublicPreview');

    let editorData = lsGet(LS_EDITOR, null);

    // ===== Portf√≥lio (Editor) - demo (n√£o salva em localStorage por tamanho) =====
    let workPhotos = []; // object URLs
    let workVideos = []; // object URLs

    function updateWorkUI(){
      const c = document.getElementById('edWorkCount');
      const g = document.getElementById('edWorkGrid');
      if(c) c.textContent = `${workPhotos.length}/${MAX_WORK_PHOTOS} fotos ‚Ä¢ ${workVideos.length}/${MAX_WORK_VIDEOS} v√≠deos`;
      if(!g) return;
      g.innerHTML = '';
      const addItem = (node)=>{
        const wrap = document.createElement('div');
        wrap.className='work-item';
        wrap.appendChild(node);
        g.appendChild(wrap);
      };
      workPhotos.forEach(url=>{
        const img=document.createElement('img');
        img.src=url;
        img.loading='lazy';
        addItem(img);
      });
      workVideos.forEach(url=>{
        const v=document.createElement('video');
        v.src=url;
        v.muted=true;
        v.playsInline=true;
        v.controls=true;
        addItem(v);
      });
    }

    function clearEditorWorks(){
      workPhotos.forEach(u=>{ try{ URL.revokeObjectURL(u);}catch(e){} });
      workVideos.forEach(u=>{ try{ URL.revokeObjectURL(u);}catch(e){} });
      workPhotos=[]; workVideos=[];
      const inP=document.getElementById('edWorkPhotos');
      const inV=document.getElementById('edWorkVideos');
      if(inP) inP.value='';
      if(inV) inV.value='';
      updateWorkUI();
    }

    function addFilesToWork(type, files){
      const arr = (type==='photo') ? workPhotos : workVideos;
      const max = (type==='photo') ? MAX_WORK_PHOTOS : MAX_WORK_VIDEOS;
      const left = Math.max(0, max - arr.length);
      const list = Array.from(files||[]).slice(0, left);
      if((files||[]).length > left){
        alert(`Limite atingido: no m√°ximo ${max} ${type==='photo'?'fotos':'v√≠deos'}.`);
      }
      list.forEach(f=>{
        try{ arr.push(URL.createObjectURL(f)); }catch(e){}
      });
      updateWorkUI();
    }



    function ensureEditorData(nome, sobrenome){
      const full = `${nome} ${sobrenome}`.trim();
      editorData = editorData || {
        first:nome||'Editor',
        last:sobrenome||'',
        full: full || 'Editor',
        stars: START_STARS,
        photo:'',
        available:false,
        xp:'iniciante',
        whats:'',
        bio:'',
        soft:'',
        portfolio:'',
        tags:[],
        done:0,
        status:'Novo',
        packages:[],
        cpf:'',
        email:'',
        dob:''
      };
      editorData.first = nome || editorData.first;
      editorData.last = sobrenome || editorData.last;
      editorData.full = full || editorData.full;
      editorData.stars = START_STARS;
      lsSet(LS_EDITOR, editorData);
    }

    function renderTagsPreview(){
      if(!edTagsPreview) return;
      const raw = (edTags?.value||'').split(',').map(s=>s.trim()).filter(Boolean).slice(0,12);
      edTagsPreview.innerHTML = raw.map(t=>`<span class="tag blue">${escapeHtml(t)}</span>`).join('');
    }

    function paintEditor(){
      if(editorName) editorName.textContent = editorData?.first || 'Editor';
      if(editorFullName) editorFullName.textContent = editorData?.full || 'Editor';

      if(editorStars) editorStars.innerHTML = renderStarsHTML(editorData?.stars ?? START_STARS, MAX_STARS);
      if(edRatingTxt) edRatingTxt.textContent = String((editorData?.stars ?? START_STARS).toFixed(1));
      if(edStarsRow) edStarsRow.innerHTML = renderStarsHTML(editorData?.stars ?? START_STARS, MAX_STARS);

      if(edDone) edDone.textContent = String(editorData?.done || 0);
      if(edStatus) edStatus.textContent = editorData?.status || 'Novo';

      if(edAvailable){
        edAvailable.checked = !!editorData?.available;
        if(edAvailText) edAvailText.textContent = editorData?.available ? 'On' : 'Off';
      }

      if(edXp) edXp.value = editorData?.xp || 'iniciante';
      if(edWhats) edWhats.value = editorData?.whats || '';
      if(edBio) edBio.value = editorData?.bio || '';
      if(edSoft) edSoft.value = editorData?.soft || '';
      if(edPortfolio) edPortfolio.value = editorData?.portfolio || '';
      if(edTags) edTags.value = (editorData?.tags || []).join(', ');

      setAvatar(editorAvatarBox, editorData?.photo, (editorData?.full||'E')[0]);

      renderTagsPreview();
      renderEditorPackages();
      updatePkgCount();
      renderPublicPreview();
    }

    editorPhoto?.addEventListener('change', async (e)=>{
      const file = e.target.files?.[0];
      if(!file || !editorData) return;
      const data = await readFileAsDataURL(file);
      editorData.photo = data;
      lsSet(LS_EDITOR, editorData);
      paintEditor();
    });

    function removeEditorPhoto(){
      if(!editorData) return;
      editorData.photo = '';
      lsSet(LS_EDITOR, editorData);
      paintEditor();
    }

    edAvailable?.addEventListener('change', ()=>{
      if(!editorData) return;
      editorData.available = !!edAvailable.checked;
      if(edAvailText) edAvailText.textContent = editorData.available ? 'On' : 'Off';
      lsSet(LS_EDITOR, editorData);
      renderPublicPreview();
    });

    edTags?.addEventListener('input', renderTagsPreview);

    function saveEditorProfile(){
      if(!editorData) editorData = {first:'Editor', last:'', full:'Editor', stars:START_STARS, packages:[]};
      editorData.xp = edXp?.value || 'iniciante';
      editorData.whats = (edWhats?.value||'').trim();
      editorData.bio = (edBio?.value||'').trim();
      editorData.soft = (edSoft?.value||'').trim();
      editorData.portfolio = (edPortfolio?.value||'').trim();
      editorData.tags = (edTags?.value||'').split(',').map(s=>s.trim()).filter(Boolean).slice(0,12);
      editorData.stars = START_STARS;
      lsSet(LS_EDITOR, editorData);
      renderPublicPreview();
      alert('Perfil do editor salvo (demo).');
    }

    function resetEditor(){
      localStorage.removeItem(LS_EDITOR);
      editorData = null;
      alert('Reset feito. Reabra como Editor para criar de novo.');
      goBackStart();
    }



    // ===== Limites / valida√ß√µes r√°pidas =====
    const MAX_EDITOR_PACKAGES = 10;
    const MAX_WORK_PHOTOS = 30;
    const MAX_WORK_VIDEOS = 10;

    // clamp para n√∫meros (ex: fotos/v√≠deos no personalizado)
    function clampInt(val, min, max){
      const n = parseInt(val||'0',10);
      if(isNaN(n)) return min;
      return Math.max(min, Math.min(max, n));
    }

    // ===== Pacotes do Editor (thumbs + s√≥ 5 + seta + atalhos) =====
    let showAllPackages = false;

    function toggleMorePackages(){
      showAllPackages = !showAllPackages;
      const btn = document.getElementById('toggleMorePkgs');
      if(btn) btn.textContent = showAllPackages ? 'Mostrar menos ‚Üë' : 'Ver mais pacotes ‚Üì';
      renderEditorPackages();
    }

    function updatePkgCount(){
      const count = (editorData?.packages || []).length;
      if(edPkgCount) edPkgCount.textContent = String(count);
      if(edPkgHint) edPkgHint.textContent = count ? 'Perfeito: voc√™ vai aparecer em pedidos compat√≠veis.' : 'Dica: selecione pelo menos 1 pacote para aparecer para clientes.';
    }

    function renderEditorPackages(){
      const wrap = document.getElementById('editorPackages');
      if(!wrap) return;

      const search = (edSearchPkg?.value || '').toLowerCase().trim();
      const quick = (edQuick?.value || 'all');

      if((search && !showAllPackages) || (quick !== 'all' && !showAllPackages)){
        showAllPackages = true;
        const btn = document.getElementById('toggleMorePkgs');
        if(btn) btn.textContent = 'Mostrar menos ‚Üë';
      }

      wrap.innerHTML = '';

      packages.forEach((p, index) => {
        if(!showAllPackages && index >= 5) return;

        const text = `${p.name} ${p.items.join(' ')}`.toLowerCase();
        if(search && !text.includes(search)) return;

        const isVideo = p.name.toLowerCase().includes('v√≠deo') || p.name.toLowerCase().includes('short');
        const isFoto  = p.name.toLowerCase().includes('foto');
        const isMix   = p.name.toLowerCase().includes('combo') || p.name.toLowerCase().includes('mix') || (isVideo && isFoto);

        if(quick === 'video' && !isVideo) return;
        if(quick === 'foto' && !isFoto) return;
        if(quick === 'mix' && !isMix) return;
        if(quick === 'audio' && index < 8) return; // √°udio a partir do pacote 9

        const checked = (editorData?.packages || []).includes(p.id);
        const audioExtras = (index >= 8) ? `<div class="pkg-meta">üéß Ajustes de √°udio inclu√≠dos</div>` : '';

        const el = document.createElement('label');
        el.className = 'pkg-item';
        el.innerHTML = `
          <div class="pkg-thumb"></div>
          <div>
            <div style="display:flex; gap:10px; align-items:flex-start;">
              <input type="checkbox" data-pkg="${p.id}" ${checked ? 'checked' : ''}>
              <div>
                <div class="pkg-title">${p.id}. ${escapeHtml(p.name)}</div>
                <div class="pkg-sub">Entrega: ${escapeHtml(p.eta)} ‚Ä¢ ${brl(p.price)}</div>
              </div>
            </div>
            <div class="pkg-meta">${p.items.map(x=>escapeHtml(x)).join(' ‚Ä¢ ')}</div>
            ${audioExtras}
          </div>
        `;
        wrap.appendChild(el);
      });

      wrap.querySelectorAll('input[type="checkbox"][data-pkg]').forEach(chk=>{
        chk.addEventListener('change', ()=>{
          const id = Number(chk.getAttribute('data-pkg'));
          if(!editorData) return;
          editorData.packages = editorData.packages || [];

          if(chk.checked){
            if(!editorData.packages.includes(id)) {
              if(editorData.packages.length >= MAX_EDITOR_PACKAGES){
                chk.checked = false;
                alert(`Limite atingido: no m√°ximo ${MAX_EDITOR_PACKAGES} pacotes por editor.`);
                return;
              }
              editorData.packages.push(id);
            }
          }else{
            editorData.packages = editorData.packages.filter(x=>x!==id);
          }
          lsSet(LS_EDITOR, editorData);
          updatePkgCount();
          renderPublicPreview();
        });
      });
    }

    edSearchPkg?.addEventListener('input', renderEditorPackages);
    edQuick?.addEventListener('change', renderEditorPackages);

    function selectAllEditorPackages(flag){
      if(!editorData) return;
      editorData.packages = flag ? packages.slice(0, MAX_EDITOR_PACKAGES).map(p=>p.id) : [];
      lsSet(LS_EDITOR, editorData);
      renderEditorPackages();
      updatePkgCount();
      renderPublicPreview();
    }

    function saveEditorPackages(){
      lsSet(LS_EDITOR, editorData);
      alert('Pacotes salvos (demo).');
    }

    function renderPublicPreview(){
      if(!edPublicPreview) return;

      const tags = (editorData?.tags || []).slice(0,8);
      const pkgs = (editorData?.packages || []).slice(0,6);

      const pkgBadges = pkgs.map(id=>{
        const p = packages.find(x=>x.id===id);
        return p ? `<span class="badge pillBlue">${escapeHtml(p.name)}</span>` : '';
      }).join('');

      const tagBadges = tags.map(t=>`<span class="badge">${escapeHtml(t)}</span>`).join('');

      const statusBadge = editorData?.available
        ? `<span class="badge you">Dispon√≠vel</span>`
        : `<span class="badge off">Indispon√≠vel</span>`;

      edPublicPreview.innerHTML = `
        <div class="eTop">
          <div style="display:flex; gap:10px; align-items:center;">
            <div class="avatar" style="width:48px;height:48px" id="pubAvatar"></div>
            <div>
              <div class="eName">${escapeHtml(editorData?.full || 'Editor')}</div>
              <div class="stars" style="margin-top:4px">${renderStarsHTML(editorData?.stars ?? START_STARS, MAX_STARS)}</div>
              <div class="eMeta">${escapeHtml(editorData?.xp || 'iniciante')} ‚Ä¢ ${escapeHtml(editorData?.soft || 'Softwares')}</div>
            </div>
          </div>
          <div style="text-align:right">
            ${statusBadge}
            <div class="eMeta" style="margin-top:6px">Pacotes: <strong>${(editorData?.packages||[]).length}</strong></div>
          </div>
        </div>

        <div class="eBio">${escapeHtml(editorData?.bio || 'Escreva uma bio curta e forte para aparecer melhor para clientes.')}</div>

        <div class="eBadges">${tagBadges || `<span class="badge off">Sem tags</span>`}</div>

        <div class="eBadges" style="margin-top:10px">${pkgBadges || `<span class="badge off">Sem pacotes selecionados</span>`}</div>

        <div class="hint" style="margin-top:10px">* Demo sem backend: informa√ß√µes ficam salvas no seu navegador.</div>
      `;

      const pubAvatar = document.getElementById('pubAvatar');
      setAvatar(pubAvatar, editorData?.photo, (editorData?.full||'E')[0]);
    }

    // ===== Tela ‚ÄúEscolher Editor‚Äù (demo) =====
    const DEMO_EDITORS = [
      { id:'d1', name:'Editor Neon',  xp:'avancado', tags:['Reels','TikTok','√Åudio'], packages:[4,6,9,11,13,14,15], available:true,  stars:START_STARS },
      { id:'d2', name:'Editor Flux',  xp:'intermediario', tags:['Foto pro','Cor cine'], packages:[1,2,3,5,8,10,12,15], available:true, stars:START_STARS },
      { id:'d3', name:'Editor Pulse', xp:'intermediario', tags:['Motion','Legendas'], packages:[4,6,7,9,11,13,15], available:true, stars:START_STARS },
      { id:'d4', name:'Editor Vibe',  xp:'iniciante', tags:['Shorts','Cortes'], packages:[4,6,7,9], available:true, stars:START_STARS },
      { id:'d5', name:'Editor Clean', xp:'avancado', tags:['√Åudio','Ru√≠do','Voz'], packages:[9,11,13,14,15], available:true, stars:START_STARS },
    ];

    function getAllEditors(){
      const list = [];
      if(editorData){
        list.push({
          id:'you',
          name: editorData.full || 'Voc√™',
          xp: editorData.xp || 'iniciante',
          tags: editorData.tags || [],
          packages: editorData.packages || [],
          available: !!editorData.available,
          photo: editorData.photo || '',
          stars: editorData.stars ?? START_STARS
        });
      }
      DEMO_EDITORS.forEach(e=> list.push({...e}));
      return list;
    }

    function isCompatible(editor, order){
      if(!editor.available) return false;
      if(order?.kind === 'package') return (editor.packages || []).includes(order.packageId);

      const vids = Number(order?.videos||0);
      const fotos = Number(order?.fotos||0);

      if(vids > 0){
        return (editor.packages||[]).some(id => {
          const p = packages.find(x=>x.id===id);
          const n = (p?.name||'').toLowerCase();
          return n.includes('v√≠deo') || n.includes('short');
        });
      }
      if(fotos > 0){
        return (editor.packages||[]).some(id => {
          const p = packages.find(x=>x.id===id);
          const n = (p?.name||'').toLowerCase();
          return n.includes('foto');
        });
      }
      return (editor.packages||[]).length > 0;
    }

    function renderPickEditors(){
      const grid = document.getElementById('editorsGrid');
      if(!grid) return;
      const sort = document.getElementById('pickSort')?.value || 'best';
      const all = getAllEditors();

      let compatible = all.filter(e => isCompatible(e, currentOrder));

      if(sort === 'fast'){
        const rank = { avancado:3, intermediario:2, iniciante:1 };
        compatible.sort((a,b)=>(rank[b.xp]||1)-(rank[a.xp]||1));
      }else{
        compatible.sort((a,b)=>(Number(b.stars||START_STARS))-(Number(a.stars||START_STARS)));
      }

      grid.innerHTML = '';
      if(!compatible.length){
        grid.innerHTML = `<div class="card full" style="grid-column:1/-1">
          <h3>Nenhum editor compat√≠vel (demo)</h3>
          <p>Pe√ßa para um editor marcar os pacotes compat√≠veis e ficar ‚ÄúDispon√≠vel‚Äù.</p>
        </div>`;
        return;
      }

      compatible.forEach(e=>{
        const you = e.id === 'you';
        const card = document.createElement('div');
        card.className = 'eCard';
        card.innerHTML = `
          <div class="eTop">
            <div style="display:flex; gap:10px; align-items:center;">
              <div class="avatar" style="width:46px;height:46px" id="pickAv_${e.id}">${escapeHtml(e.name[0])}</div>
              <div>
                <div class="eName">${escapeHtml(e.name)} ${you ? '‚Ä¢ (Voc√™)' : ''}</div>
                <div class="stars" style="margin-top:4px">${renderStarsHTML(e.stars ?? START_STARS, MAX_STARS)}</div>
                <div class="eMeta">${escapeHtml(e.xp)} ‚Ä¢ Pacotes: ${e.packages?.length||0}</div>
              </div>
            </div>
            <div><span class="badge ${e.available ? 'you' : 'off'}">${e.available ? 'Dispon√≠vel' : 'Off'}</span></div>
          </div>

          <div class="eBio">${escapeHtml((e.tags||[]).slice(0,5).join(' ‚Ä¢ ') || 'Editor demo')}</div>
          <div class="eBadges">
            ${(e.tags||[]).slice(0,6).map(t=>`<span class="badge pillBlue">${escapeHtml(t)}</span>`).join('') || `<span class="badge off">Sem tags</span>`}
          </div>

          <button class="btn" type="button" onclick="selectEditor('${e.id}')">Selecionar este editor</button>
          <div class="hint">* Demo: sem pagamento/entrega real ainda.</div>
        `;
        grid.appendChild(card);
        const av = document.getElementById(`pickAv_${e.id}`);
        if(av) setAvatar(av, e.photo || '', e.name[0]);
      });
    }

    document.getElementById('pickSort')?.addEventListener('change', renderPickEditors);

    function selectEditor(id){
      if(id === 'you' && !editorData?.available){
        alert('Seu perfil est√° como OFF. Ative ‚ÄúDispon√≠vel‚Äù no painel do editor.');
        return;
      }
      alert('Editor selecionado! (demo)\nNa pr√≥xima etapa vamos criar: checkout + envio de arquivos + chat.');
    }

    // ===== Cadastro (modal) =====
    function buildClientDefaults(){
      return {
        first:'Cliente', last:'', full:'Cliente',
        stars: START_STARS,
        photo:'',
        whats:'', city:'', niche:'', mainPlatform:'instagram', about:'',
        cpf:'', email:'', dob:''
      };
    }
    function buildEditorDefaults(){
      return {
        first:'Editor', last:'', full:'Editor',
        stars: START_STARS,
        photo:'',
        available:false,
        xp:'iniciante', whats:'', bio:'', soft:'', portfolio:'', tags:[],
        done:0, status:'Novo', packages:[],
        cpf:'', email:'', dob:''
      };
    }

    function saveAccount(kind, account){
      const acc = getAccounts();
      acc[kind] = acc[kind] || {};
      acc[kind][normEmail(account.email)] = account;
      setAccounts(acc);
    }

    function loadAccount(kind, email){
      const acc = getAccounts();
      return acc?.[kind]?.[normEmail(email)] || null;
    }

    function applyAccountToSession(kind, account){
      if(kind === 'client'){
        clientData = account.profile;
        lsSet(LS_CLIENT, clientData);
        paintClientProfile();
        paintClientTop();
      }else{
        editorData = account.profile;
        lsSet(LS_EDITOR, editorData);
        paintEditor();
      }
    }

    btnCadastrar?.addEventListener('click', ()=>{
      const nome=(inNome?.value||'').trim();
      const sobrenome=(inSobrenome?.value||'').trim();
      const dob=(inData?.value||'').trim();
      const cpfRaw=(inCPF?.value||'').trim();
      const cpfD=cpfDigits(cpfRaw);
      const email=(inEmail?.value||'').trim();
      const senha=(inSenha?.value||'').trim();

      // Atalho ADM (testes)
      if(String(nome).trim().toLowerCase() === 'adm'){
        closeCadastro();
        if(role==='cliente'){
          clientData = buildClientDefaults();
          clientData.first = 'ADM';
          clientData.full = 'ADM';
          lsSet(LS_CLIENT, clientData);
          paintClientProfile();
          showScreen(screenClientProfile);
        }else{
          editorData = buildEditorDefaults();
          editorData.first = 'ADM';
          editorData.full = 'ADM';
          lsSet(LS_EDITOR, editorData);
          paintEditor();
          showScreen(screenEditor);
        }
        return;
      }

      if(!nome||!sobrenome){ alert('Preencha Nome e Sobrenome.'); return; }
      if(!dob){ alert('Preencha a data de nascimento.'); return; }
      if(!email){ alert('Preencha o email.'); return; }
      if(!senha || senha.length < 4){ alert('Crie uma senha (m√≠nimo 4 caracteres).'); return; }
      if(!isValidCPF(cpfD)){ alert('CPF inv√°lido.'); return; }

      if(role === 'editor'){
        const age = calcAge(dob);
        if(!(age >= 18)){
          alert('Para ser Editor precisa ter 18+.\nMenores: somente no futuro com autoriza√ß√£o dos pais e foto do RG (backend).');
          return;
        }
      }

      const kind = roleKey(); // client | editor
      const acc = getAccounts();
      acc[kind] = acc[kind] || {};

      const eKey = normEmail(email);
      if(acc[kind][eKey]){
        alert('Esse email j√° est√° cadastrado. Clique em "J√° tenho conta" para entrar.');
        return;
      }

      const existingEmail = findEmailByCPF(kind, cpfD);
      if(existingEmail){
        alert('Esse CPF j√° est√° cadastrado nessa modalidade de conta.\nUse "J√° tenho conta" para entrar.');
        return;
      }

      closeCadastro();

      if(role==='cliente'){
        ensureClientData(nome, sobrenome);
        clientData.cpf = cpfD;
        clientData.email = eKey;
        clientData.dob = dob;
        clientData.stars = START_STARS;
        lsSet(LS_CLIENT, clientData);

        saveAccount('client', { email:eKey, pass:senha, cpf:cpfD, profile: clientData });

        paintClientProfile();
        showScreen(screenClientProfile);
      }else{
        ensureEditorData(nome, sobrenome);
        editorData.cpf = cpfD;
        editorData.email = eKey;
        editorData.dob = dob;
        editorData.stars = START_STARS;
        lsSet(LS_EDITOR, editorData);

        saveAccount('editor', { email:eKey, pass:senha, cpf:cpfD, profile: editorData });

        paintEditor();
        showScreen(screenEditor);
      }
    });

    btnLogin?.addEventListener('click', ()=>{
      const email=(loginEmail?.value||'').trim();
      const senha=(loginSenha?.value||'').trim();
      if(!email || !senha){
        alert('Preencha email e senha.');
        return;
      }

      // Atalho ADM (testes): se o usu√°rio digitar "adm" no email ou na senha,
      // pulamos a valida√ß√£o de contas e entramos diretamente como ADM.
      if(String(email).trim().toLowerCase() === 'adm' || String(senha).trim().toLowerCase() === 'adm'){
        closeCadastro();
        if(role === 'cliente'){
          // cria perfil de cliente ADM e navega para o perfil do cliente
          clientData = buildClientDefaults();
          clientData.first = 'ADM';
          clientData.full  = 'ADM';
          lsSet(LS_CLIENT, clientData);
          paintClientProfile();
          paintClientTop();
          showScreen(screenClientProfile);
        }else{
          // cria perfil de editor ADM e navega para o dashboard do editor
          editorData = buildEditorDefaults();
          editorData.first = 'ADM';
          editorData.full  = 'ADM';
          lsSet(LS_EDITOR, editorData);
          paintEditor();
          showScreen(screenEditor);
        }
        return;
      }

      const kind = roleKey();
      const account = loadAccount(kind, email);
      if(!account || account.pass !== senha){
        alert('Email ou senha incorretos (demo).');
        return;
      }

      closeCadastro();
      applyAccountToSession(kind, account);

      if(role==='cliente') showScreen(screenClientProfile);
      else showScreen(screenEditor);
    });

    // ===== IA Karamelo (demo local ‚Äî Cliente + Editor + novos usu√°rios) =====
    const aiFab = document.getElementById('aiFab');
    const aiPanel = document.getElementById('aiPanel');
    const aiClose = document.getElementById('aiClose');
    const aiMsgs = document.getElementById('aiMsgs');
    const aiForm = document.getElementById('aiForm');
    const aiInput = document.getElementById('aiInput');
    const aiChips = document.getElementById('aiChips');

    const AI_INTRO_KEY = 'karamelo_ai_intro_v1';

    function aiAdd(text, me=false){
      if(!aiMsgs) return;
      const div = document.createElement('div');
      div.className = 'aiMsg' + (me ? ' me' : '');
      div.innerHTML = escapeHtml(String(text||'')).replace(/\n/g,'<br>');
      aiMsgs.appendChild(div);
      aiMsgs.scrollTop = aiMsgs.scrollHeight;
    }

    function aiGetScreen(){
      if(screenEditor?.classList.contains('show')) return 'editor';
      if(screenClientProfile?.classList.contains('show')) return 'cliente_perfil';
      if(screenClient?.classList.contains('show')) return 'cliente';
      if(screenPickEditor?.classList.contains('show')) return 'escolha_editor';
      return 'start';
    }

    function aiSuggestPackages(){
      // dica simples baseada em quantidade (se o usu√°rio estiver no personalizado)
      const fotos = parseInt(document.getElementById('custFotos')?.value || '0', 10) || 0;
      const vids  = parseInt(document.getElementById('custVideos')?.value || '0', 10) || 0;
      if(fotos === 0 && vids === 0){
        return 'Para come√ßar r√°pido: ‚ÄúStarter Foto‚Äù (1 foto) ou ‚ÄúV√≠deo Short 15s‚Äù.\nSe voc√™ j√° sabe quantas fotos/v√≠deos quer, use o Personalizado e eu te ajudo a montar.';
      }
      if(vids > 0 && fotos === 0){
        return `Voc√™ colocou ${vids} v√≠deo(s). Dica: escolha o tipo (15s/45s/60s) e marque extras como Legendas/Cor cine.\nSe quiser rapidez, deixe sem extras e sem Urgente.`;
      }
      if(fotos > 0 && vids === 0){
        return `Voc√™ colocou ${fotos} foto(s). Dica: marque Retoque avan√ßado se for produto/beleza.\nSe for s√≥ ajuste, deixe sem extras para ficar mais barato.`;
      }
      return `Voc√™ colocou ${fotos} foto(s) e ${vids} v√≠deo(s). Dica: use ‚ÄúCombo Social‚Äù se quer algo pronto, ou finalize no Personalizado com extras s√≥ no que precisa.`;
    }

    function aiHelp(topic){
      const where = aiGetScreen();
      if(topic === 'novo'){
        aiAdd('Bem-vindo(a) √† Karamelo! ‚ú®\n\n‚Ä¢ Se voc√™ quer comprar edi√ß√£o: clique em ‚ÄúSou Cliente‚Äù ‚Üí Criar conta ‚Üí preencha o perfil ‚Üí escolha um pacote ou o Personalizado.\n‚Ä¢ Se voc√™ quer trabalhar: clique em ‚ÄúQuero Trabalhar‚Äù ‚Üí Criar conta ‚Üí complete o perfil ‚Üí selecione at√© 10 pacotes ‚Üí ative ‚ÄúDispon√≠vel‚Äù.');
        return;
      }
      if(topic === 'cliente'){
        aiAdd('Modo Cliente ‚úÖ\n\n1) Crie sua conta e complete o perfil.\n2) Escolha um pacote pronto ou monte o Personalizado.\n3) Depois, selecione um editor compat√≠vel (demo).\n\nSe quiser, me diga ‚Äúquantas fotos e v√≠deos‚Äù e eu sugiro o melhor caminho.');
        if(where === 'cliente' || where === 'cliente_perfil') aiAdd('Dica: no Personalizado, marque s√≥ os extras essenciais (ex: Legendas + Cor cine) para n√£o encarecer demais.');
        return;
      }
      if(topic === 'editor'){
        aiAdd('Modo Editor ‚úÖ\n\n1) Complete seu perfil (bio curta + softwares + tags).\n2) Selecione os pacotes que voc√™ aceita (limite: 10).\n3) Ative ‚ÄúDispon√≠vel‚Äù para aparecer para clientes.\n4) Portf√≥lio: at√© 30 fotos e 10 v√≠deos (demo).');
        aiAdd('Sugest√£o de bio: ‚ÄúCortes r√°pidos + cor cinematogr√°fica + √°udio limpo. Reels/TikTok. Entrega r√°pida.‚Äù');
        return;
      }
      if(topic === 'pacotes'){
        aiAdd(aiSuggestPackages());
        return;
      }
      if(topic === 'bio'){
        aiAdd('Bio/Tags (Editor) ‚úçÔ∏è\n\nBio curta (1‚Äì2 linhas) + 4‚Äì8 tags.\nExemplo tags: Reels, TikTok, Legendas, Cor cine, √Åudio, Foto pro.\n\nSe voc√™ me disser seu estilo, eu monto uma bio pronta.');
        return;
      }
    }

    function aiOpen(){
      if(!aiPanel) return;
      aiPanel.classList.add('show');
      aiPanel.setAttribute('aria-hidden','false');
      if(aiMsgs && aiMsgs.childElementCount === 0){
        aiHelp('novo');
      }
      document.getElementById('aiInput')?.focus();
    }
    function aiClosePanel(){
      aiPanel?.classList.remove('show');
      aiPanel?.setAttribute('aria-hidden','true');
    }

    function aiReply(userText){
      const t = String(userText||'').toLowerCase();
      if(t.includes('primeiro') || t.includes('come√ßar') || t.includes('novo')) return aiHelp('novo');
      if(t.includes('cliente') || t.includes('comprar') || t.includes('pedido')) return aiHelp('cliente');
      if(t.includes('editor') || t.includes('trabalhar') || t.includes('portf√≥lio') || t.includes('portfolio')) return aiHelp('editor');
      if(t.includes('pacote') || t.includes('pre√ßo') || t.includes('personalizado') || t.includes('fotos') || t.includes('v√≠deos') || t.includes('videos')) return aiHelp('pacotes');
      if(t.includes('bio') || t.includes('tag')) return aiHelp('bio');
      aiAdd('Entendi! Me diga se voc√™ √© Cliente ou Editor e o que voc√™ quer fazer agora (ex: ‚Äúquero 3 v√≠deos de 15s com legenda‚Äù).');
    }

    aiFab?.addEventListener('click', ()=>{
      if(aiPanel?.classList.contains('show')) aiClosePanel();
      else aiOpen();
    });
    aiClose?.addEventListener('click', aiClosePanel);

    aiChips?.addEventListener('click', (e)=>{
      const btn = e.target?.closest('button[data-ai]');
      if(!btn) return;
      aiHelp(String(btn.getAttribute('data-ai')||''));
    });

    aiForm?.addEventListener('submit', (e)=>{
      e.preventDefault();
      const msg = String(aiInput?.value || '').trim();
      if(!msg) return;
      aiAdd(msg, true);
      aiInput.value = '';
      setTimeout(()=> aiReply(msg), 120);
    });

    // ===== Init =====
    window.addEventListener('DOMContentLoaded', ()=>{
      // Portfolio inputs
      const edWorkPhotos = document.getElementById('edWorkPhotos');
      const edWorkVideos = document.getElementById('edWorkVideos');
      edWorkPhotos?.addEventListener('change', (e)=>{ addFilesToWork('photo', e.target.files); });
      edWorkVideos?.addEventListener('change', (e)=>{ addFilesToWork('video', e.target.files); });
      updateWorkUI();

      // Clamp inputs num√©ricos (evita digitar infinito)
      const cf = document.getElementById('custFotos');
      const cv = document.getElementById('custVideos');
      cf?.addEventListener('input', ()=>{ cf.value = String(clampInt(cf.value,0,999)); });
      cv?.addEventListener('input', ()=>{ cv.value = String(clampInt(cv.value,0,999)); });

      // WhatsApp: s√≥ n√∫meros + ()- e espa√ßo
      const telFix = (el)=>{
        if(!el) return;
        el.addEventListener('input', ()=>{
          el.value = String(el.value||'').replace(/[^0-9()\-\s+]/g,'').slice(0,15);
        });
      };
      telFix(document.getElementById('clWhats'));
      telFix(document.getElementById('edWhats'));

      clientData = lsGet(LS_CLIENT, clientData);
      editorData = lsGet(LS_EDITOR, editorData);

      // pinta estado se j√° tiver algo salvo
      if(clientData){ paintClientProfile(); paintClientTop(); }
      if(editorData){ paintEditor(); }

      calcCustom();

      // IA: abre automaticamente 1x para quem nunca entrou (somente se n√£o estiver com modal aberto)
      try{
        if(!localStorage.getItem(AI_INTRO_KEY)){
          setTimeout(()=>{
            if(!overlay?.classList.contains('show')) aiOpen();
            localStorage.setItem(AI_INTRO_KEY,'1');
          }, 700);
        }
      }catch(e){}
    });

  </script>
</body>
</html>
