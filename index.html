<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Karamello | Edi√ß√£o Profissional</title>

  <style>
    :root{
      --bg:#070b18;
      --panel:#0b1226;
      --text:#e5e7eb;
      --muted:#9ca3af;

      --accent1:#7c3aed; /* roxo */
      --accent2:#2563eb; /* azul */
      --accent3:#38bdf8; /* ciano */

      --border:rgba(255,255,255,.12);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      color:var(--text);
      overflow-x:hidden;
      color-scheme: dark;
      background: var(--bg);
      position:relative;
    }

    /* ‚úÖ Fundo degrad√™ 3 cores (fosco) */
    .bg{
      position:fixed; inset:0; z-index:-3;
      background:
        radial-gradient(1200px 800px at 12% 10%, rgba(124,58,237,.34), transparent 62%),
        radial-gradient(1200px 800px at 88% 12%, rgba(37,99,235,.30), transparent 62%),
        radial-gradient(1100px 900px at 50% 85%, rgba(56,189,248,.16), transparent 62%),
        linear-gradient(135deg, rgba(124,58,237,.18) 0%, rgba(37,99,235,.16) 48%, rgba(56,189,248,.10) 100%),
        linear-gradient(180deg, rgba(7,11,24,.98), rgba(5,8,18,.99));
      filter:saturate(1.1);
    }

    /* ‚úÖ Orbs animadas leves */
    .orb{
      position:fixed;
      width:520px; height:520px;
      border-radius:50%;
      z-index:-2;
      opacity:.34;
      filter: blur(22px);
      animation: float 14s ease-in-out infinite;
      pointer-events:none;
      transform: translateZ(0);
      will-change: transform;
      mix-blend-mode: screen;
    }
    .orb.one{
      left:-180px; top:130px;
      background: radial-gradient(circle at 35% 35%, rgba(124,58,237,.92), rgba(124,58,237,0) 60%);
      animation-duration: 16s;
    }
    .orb.two{
      right:-240px; top:60px;
      background: radial-gradient(circle at 40% 35%, rgba(37,99,235,.90), rgba(37,99,235,0) 60%);
      animation-duration: 18s;
      animation-delay: -3s;
    }
    .orb.three{
      left:22%; bottom:-280px;
      width:680px; height:680px;
      background: radial-gradient(circle at 50% 40%, rgba(56,189,248,.70), rgba(56,189,248,0) 62%);
      animation-duration: 20s;
      animation-delay: -5s;
    }
    @keyframes float{
      0%{ transform: translate3d(0,0,0) scale(1); }
      50%{ transform: translate3d(0,-16px,0) scale(1.02); }
      100%{ transform: translate3d(0,0,0) scale(1); }
    }

    /* ‚úÖ Sparkles leves */
    .sparkles{
      position:fixed; inset:0; z-index:-1;
      pointer-events:none;
      opacity:.18;
      background-image:
        radial-gradient(circle, rgba(255,255,255,.24) 1px, transparent 1.8px),
        radial-gradient(circle, rgba(56,189,248,.15) 1px, transparent 1.8px);
      background-size: 76px 76px, 100px 100px;
      background-position: 0 0, 28px 22px;
      will-change: transform;
      transform: translateZ(0);
      animation: drift 28s linear infinite;
    }
    @keyframes drift{
      from{ transform: translate3d(0,0,0); }
      to{ transform: translate3d(-80px, -60px, 0); }
    }

    /* ‚úÖ Entrada */
    .page{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      opacity:0;
      transform: translateY(8px);
      animation: pageIn .55s ease forwards;
    }
    @keyframes pageIn{to{opacity:1; transform:translateY(0)}}

    header{
      padding:44px 18px 28px;
      background: linear-gradient(90deg,
        rgba(124,58,237,.55),
        rgba(37,99,235,.50),
        rgba(56,189,248,.25)
      );
      border-bottom:1px solid rgba(255,255,255,.12);
    }
    .wrap{max-width:1100px;margin:0 auto}
    h1{
      margin:0;
      font-size: clamp(2rem, 3.4vw, 3rem);
      letter-spacing:.3px;
    }
    .subtitle{
      margin-top:10px;
      color: rgba(229,231,235,.9);
      font-size:1.05rem;
    }

    main{padding:26px 18px 60px; position:relative;}
    main::before{
      content:"";
      position:absolute; inset:0;
      background: rgba(2,6,23,.18);
      pointer-events:none;
    }
    main > .wrap{position:relative; z-index:1;}

    .screen{display:none;opacity:0;transform: translateY(10px);}
    .screen.show{display:block;animation: screenIn .35s ease forwards;}
    @keyframes screenIn{to{opacity:1;transform:translateY(0)}}

    .hero{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:18px;
      align-items:stretch;
    }
    @media (max-width: 860px){ .hero{grid-template-columns:1fr} }

    /* ‚úÖ CARD OTIMIZADO */
    .card{
      background: linear-gradient(180deg, rgba(11,18,38,.92), rgba(10,16,34,.88));
      border:1px solid var(--border);
      border-radius:18px;
      padding:18px;
      box-shadow: 0 10px 26px rgba(0,0,0,.35);
      content-visibility: auto;
      contain-intrinsic-size: 320px 220px;
      contain: layout paint style;
    }
    .card h3{margin:0 0 8px;font-size:1.15rem;color:#c7d2fe;}
    .card p{margin:0;color:var(--muted);line-height:1.35}

    .btn{
      margin-top:14px;
      width:100%;
      padding:12px 14px;
      border:none;
      border-radius:12px;
      background: linear-gradient(90deg, var(--accent1), var(--accent2));
      color:white;
      font-weight:700;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
    }
    .btn:hover{transform: translateY(-1px); filter: brightness(1.04);}
    .btn:active{transform: translateY(0px); filter: brightness(.98);}
    .btn.secondary{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.14);
      color: var(--text);
    }
    .btn.small{
      width:auto;
      padding:10px 12px;
      border-radius:12px;
      margin-top:0;
      font-size:.95rem;
    }

    .section-title{margin:26px 0 12px; color:#c7d2fe; font-size:1.25rem;}
    .pill{display:inline-block;margin-top:6px;color:var(--muted);font-size:.95rem;}

    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:14px;
    }
    @media (max-width: 980px){ .grid{grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 620px){ .grid{grid-template-columns: 1fr;} }
    .grid .full{grid-column: 1 / -1;}

    .price{margin:10px 0 10px;font-weight:900;font-size:1.25rem;color: var(--accent3);}
    ul{margin:10px 0 0; padding-left:18px; color:#cbd5e1}
    li{margin:6px 0}

    .card.highlight{
      border:1px solid rgba(56,189,248,.35);
      box-shadow:0 12px 28px rgba(0,0,0,.38), 0 0 0 4px rgba(56,189,248,.05);
    }

    .overlay{
      position:fixed; inset:0;
      background: rgba(0,0,0,.62);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:1000;
    }
    .overlay.show{display:flex; animation: fadeIn .2s ease forwards;}
    .overlay.closing{animation: fadeOut .22s ease forwards;}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    @keyframes fadeOut{from{opacity:1}to{opacity:0}}

    .modal{
      width:min(520px, 100%);
      background: linear-gradient(180deg, rgba(11,18,38,.95), rgba(10,16,34,.92));
      border:1px solid rgba(255,255,255,.16);
      border-radius:18px;
      box-shadow: 0 30px 80px rgba(0,0,0,.60);
      overflow:hidden;
      transform: translateY(10px) scale(.98);
      opacity:0;
      animation: modalIn .25s ease forwards;
    }
    .modal.closing{animation: modalOut .22s ease forwards;}
    @keyframes modalIn{to{opacity:1;transform:translateY(0) scale(1)}}
    @keyframes modalOut{to{opacity:0;transform:translateY(8px) scale(.98)}}

    .modalHead{
      padding:16px 18px;
      background: linear-gradient(90deg, rgba(124,58,237,.72), rgba(37,99,235,.72));
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .modalHead strong{font-size:1.05rem}
    .close{
      width:36px;height:36px;
      border-radius:12px;
      border:none;
      cursor:pointer;
      background: rgba(255,255,255,.14);
      color:white;
      font-size:18px;
    }
    .modalBody{padding:18px}
    .field{margin-bottom:12px}
    .field label{display:block;font-size:.88rem;color:#cbd5e1;margin:0 0 6px}

    input, textarea, select{
      width:100%;
      padding:11px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      outline:none;
      color-scheme: dark;
    }
    textarea{min-height:96px; resize:vertical;}
    input::placeholder, textarea::placeholder{color: rgba(229,231,235,.68)}
    input:focus, textarea:focus, select:focus{border-color: rgba(56,189,248,.55)}
    select option{background: var(--panel); color: var(--text);}
    input[type="date"]::-webkit-datetime-edit{ color: var(--text); }
    input[type="date"]::-webkit-calendar-picker-indicator{filter: invert(1);opacity:.85;cursor:pointer;}
    .hint{color:var(--muted); font-size:.9rem; margin-top:10px}

    .mini-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .mini label{display:block;font-size:.88rem;color:#cbd5e1;margin:0 0 6px}

    .checks{display:grid;gap:8px}
    .chk{display:flex;gap:10px;align-items:center;color:#cbd5e1;font-size:.95rem}
    .chk input{width:auto;margin:0}

    .total-box{
      margin-top:12px;
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(56,189,248,.22);
      background: rgba(56,189,248,.06);
    }
    .total-line{display:flex;justify-content:space-between;align-items:center}
    .total-line strong{font-size:1.25rem;color:var(--accent3)}
    .total-sub{margin-top:6px;color:var(--muted);font-size:.95rem}

    footer{padding:18px;color:rgba(229,231,235,.7);text-align:center;}

    /* ‚úÖ MODO LEVE AUTOM√ÅTICO */
    @media (prefers-reduced-motion: reduce){
      .orb, .sparkles{ animation: none !important; }
    }
    @media (max-width: 900px){
      .sparkles{ display:none; }
      .orb{ filter: blur(16px); opacity:.28; }
    }

    /* ===== Avatares + Estrelas ===== */
    .who{
      display:flex; align-items:center; gap:10px;
      margin-top:10px;
    }
    .avatar{
      width:44px; height:44px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background:
        radial-gradient(circle at 30% 30%, rgba(56,189,248,.55), transparent 55%),
        radial-gradient(circle at 70% 70%, rgba(124,58,237,.55), transparent 55%),
        rgba(255,255,255,.06);
      box-shadow: 0 10px 24px rgba(0,0,0,.35);
      overflow:hidden;
      flex:0 0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
      color:rgba(229,231,235,.92);
    }
    .avatar img{width:100%;height:100%;object-fit:cover;display:block;}
    .who .meta{display:flex;flex-direction:column;gap:2px}
    .stars{
      display:inline-flex; gap:3px; align-items:center;
      font-size:14px;
      letter-spacing:.2px;
      flex-wrap:wrap;
    }
    .star{
      color: rgba(56,189,248,.95);
      text-shadow: 0 0 10px rgba(56,189,248,.25);
    }
    .star.off{
      color: rgba(229,231,235,.28);
      text-shadow:none;
    }
    .stars small{
      color: rgba(229,231,235,.70);
      margin-left:8px;
      font-size:.9rem;
      font-weight:700;
    }

    /* ===== B: Sele√ß√£o de Editores (Cliente) ===== */
    .toolbar{
      display:flex; gap:10px; flex-wrap:wrap;
      align-items:center; justify-content:space-between;
      margin-top:12px;
    }
    .toolbar .left, .toolbar .right{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    .chip{
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:#e5e7eb;
      font-size:.92rem;
    }
    .editor-cards{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:14px;
      margin-top:12px;
    }
    @media (max-width: 980px){ .editor-cards{grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 620px){ .editor-cards{grid-template-columns: 1fr;} }

    .eCard{
      background: linear-gradient(180deg, rgba(11,18,38,.92), rgba(10,16,34,.88));
      border:1px solid rgba(255,255,255,.12);
      border-radius:18px;
      padding:14px;
      box-shadow: 0 10px 26px rgba(0,0,0,.35);
      content-visibility:auto;
      contain-intrinsic-size: 320px 280px;
      contain: layout paint style;
    }
    .eTop{display:flex; justify-content:space-between; align-items:flex-start; gap:10px;}
    .eName{font-weight:900; color:#e5e7eb; font-size:1.05rem}
    .eMeta{color:rgba(229,231,235,.70); font-size:.92rem; margin-top:4px}
    .eBio{margin-top:10px;color:rgba(156,163,175,.95);line-height:1.35;font-size:.95rem;}
    .eBadges{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px;}
    .badge{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:#e5e7eb;
      font-size:.9rem;
    }
    .badge.pillBlue{border-color: rgba(124,58,237,.30);background: rgba(124,58,237,.10);}
    .badge.you{border-color: rgba(56,189,248,.30);background: rgba(56,189,248,.10);}
    .badge.off{opacity:.6}

    /* ===== Editor Dashboard ===== */
    .editor-grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:14px;
      margin-top:14px;
      align-items:start;
    }
    @media (max-width: 860px){ .editor-grid{grid-template-columns:1fr;} }

    .kpi{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap:10px;
      margin-top:10px;
    }
    .kpi .k{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      border-radius:14px;
      padding:10px;
      min-height:66px;
    }
    .k .t{color:rgba(229,231,235,.72); font-size:.85rem}
    .k .v{font-weight:900; margin-top:6px; font-size:1.05rem; color:#c7d2fe}
    .k .v small{font-weight:700; color:rgba(229,231,235,.75); font-size:.9rem}

    .row-inline{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
    }

    .switch{
      display:inline-flex; align-items:center; gap:10px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      user-select:none;
    }
    .switch input{ display:none; }
    .track{
      width:44px; height:24px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      position:relative;
      transition: .15s ease;
      flex:0 0 auto;
    }
    .thumb{
      width:18px; height:18px; border-radius:50%;
      position:absolute; top:50%; transform: translateY(-50%);
      left:3px;
      background: rgba(229,231,235,.85);
      transition: .15s ease;
      box-shadow: 0 6px 16px rgba(0,0,0,.35);
    }
    .switch input:checked + .track{
      background: rgba(56,189,248,.16);
      border-color: rgba(56,189,248,.35);
    }
    .switch input:checked + .track .thumb{
      left:23px;
      background: rgba(56,189,248,.95);
      box-shadow: 0 0 16px rgba(56,189,248,.35);
    }
    .switch .label{
      color:#e5e7eb; font-weight:800; font-size:.95rem;
    }
    .switch .sub{
      color:rgba(229,231,235,.72); font-size:.85rem; margin-top:2px;
    }

    .tags{
      display:flex; flex-wrap:wrap; gap:8px;
      margin-top:8px;
    }
    .tag{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:#e5e7eb;
      font-size:.88rem;
    }
    .tag.blue{
      border-color: rgba(56,189,248,.25);
      background: rgba(56,189,248,.08);
    }

    .pkg-list{display:grid; gap:10px; margin-top:10px;}

    /* ‚úÖ THUMB (preenche o vazio) + layout */
    .pkg-item{
      display:grid;
      grid-template-columns: 92px 1fr;
      gap:14px;
      align-items:start;
      padding:10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
    }
    .pkg-thumb{
      width:88px;
      height:88px;
      border-radius:14px;
      background:
        radial-gradient(circle at 30% 30%, rgba(56,189,248,.35), transparent 60%),
        radial-gradient(circle at 70% 70%, rgba(124,58,237,.35), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 10px 24px rgba(0,0,0,.35);
      flex-shrink:0;
    }
    .pkg-item input{ margin-top:4px; width:auto; }
    .pkg-title{ font-weight:900; color:#e5e7eb }
    .pkg-sub{ color:rgba(229,231,235,.72); font-size:.92rem; margin-top:2px }
    .pkg-meta{ color:rgba(156,163,175,.92); font-size:.9rem; margin-top:6px }

    .uploadRow{
      display:flex; gap:12px; align-items:center; flex-wrap:wrap;
      margin-top:10px;
    }
    .uploadRow .avatar{width:56px;height:56px}

    /* ‚ÄúVer mais‚Äù centralizado */
    .moreRow{
      margin-top:10px;
      display:flex;
      justify-content:center;
    }
  </style>
</head>

<body>
  <div class="bg"></div>
  <div class="orb one"></div>
  <div class="orb two"></div>
  <div class="orb three"></div>
  <div class="sparkles"></div>

  <div class="page">
    <header>
      <div class="wrap">
        <h1>Karamello</h1>
        <div class="subtitle">Plataforma profissional de edi√ß√£o de fotos e v√≠deos</div>
      </div>
    </header>

    <main>
      <div class="wrap">

        <!-- START -->
        <section id="screenStart" class="screen show">
          <div class="hero">
            <div class="card">
              <h3>Sou Cliente</h3>
              <p>Crie seu perfil de comprador e depois escolha um pacote pronto ou monte um personalizado.</p>
              <button class="btn" type="button" onclick="openCadastro('cliente')">Criar conta (Cliente)</button>
            </div>
            <div class="card">
              <h3>Quero Trabalhar</h3>
              <p>Cadastre-se como editor, complete o perfil e fique dispon√≠vel para receber pedidos.</p>
              <button class="btn" type="button" onclick="openCadastro('editor')">Criar conta (Editor)</button>
            </div>
          </div>
        </section>

        <!-- CLIENTE: PERFIL (ANTES DOS PACOTES) -->
        <section id="screenClientProfile" class="screen">
          <div class="section-title">Seu perfil (Cliente)</div>
          <div class="pill">Complete seu perfil para uma experi√™ncia melhor (come√ßa com 5 estrelas).</div>

          <div class="card" style="margin-top:12px">
            <div class="who">
              <div class="avatar" id="clientAvatarBox"></div>
              <div class="meta">
                <div style="font-weight:900" id="clientProfileName">Cliente</div>
                <div class="stars" id="clientStars"></div>
              </div>
            </div>

            <div class="uploadRow">
              <label class="btn secondary small" style="cursor:pointer">
                Enviar foto
                <input id="clientPhoto" type="file" accept="image/*" style="display:none">
              </label>
              <button class="btn secondary small" type="button" onclick="removeClientPhoto()">Remover</button>
              <div class="hint" style="margin-top:0">* Foto opcional (salva no navegador).</div>
            </div>

            <div class="mini-grid" style="margin-top:12px">
              <div class="mini">
                <label>WhatsApp</label>
                <input id="clWhats" placeholder="(DDD) 99999-9999" />
              </div>
              <div class="mini">
                <label>Cidade</label>
                <input id="clCity" placeholder="Ex: S√£o Paulo - SP" />
              </div>
            </div>

            <div class="mini-grid" style="margin-top:10px">
              <div class="mini">
                <label>Nicho / Categoria</label>
                <input id="clNiche" placeholder="Ex: Moda, Gaming, Fitness, Loja, Influencer..." />
              </div>
              <div class="mini">
                <label>Rede principal</label>
                <select id="clMainPlatform">
                  <option value="instagram">Instagram</option>
                  <option value="tiktok">TikTok</option>
                  <option value="youtube">YouTube</option>
                  <option value="facebook">Facebook</option>
                  <option value="kwai">Kwai</option>
                  <option value="pinterest">Pinterest</option>
                  <option value="linkedin">LinkedIn</option>
                  <option value="x">X (Twitter)</option>
                </select>
              </div>
            </div>

            <div class="field" style="margin-top:10px">
              <label>Sobre voc√™ / Objetivo</label>
              <textarea id="clAbout" placeholder="Ex: Quero v√≠deos curtos para Reels/TikTok, estilo cinematogr√°fico, cortes r√°pidos, legendas..."></textarea>
            </div>

            <div class="mini-grid" style="margin-top:12px">
              <button class="btn" type="button" onclick="saveClientProfileAndGo()">Salvar e continuar</button>
              <button class="btn secondary" type="button" onclick="goBackStart()">Voltar</button>
            </div>
          </div>
        </section>

        <!-- CLIENTE: PACOTES -->
        <section id="screenClient" class="screen">
          <div class="who">
            <div class="avatar" id="clientAvatarTop"></div>
            <div class="meta">
              <div class="section-title" style="margin:0">Bem-vindo, <span id="clientName">Cliente</span> üëã</div>
              <div class="stars" id="clientStarsTop"></div>
            </div>
          </div>

          <div class="pill" style="margin-top:10px">Escolha um pacote pronto ou monte um pacote personalizado.</div>

          <div class="section-title" style="margin-top:18px">Pacotes prontos (15 op√ß√µes)</div>
          <div id="packagesGrid" class="grid" style="margin-top:12px"></div>

          <div class="section-title" style="margin-top:26px">Pacote Personalizado ‚ú®</div>
          <div class="grid" style="margin-top:12px">
            <div class="card highlight full">
              <h3>Monte seu pacote</h3>
              <p>Escolha quantas fotos/v√≠deos voc√™ quer, plataforma e tipo de v√≠deo. O site soma tudo por tr√°s e mostra s√≥ o total.</p>

              <div class="mini-grid" style="margin-top:12px">
                <div class="mini">
                  <label>Fotos</label>
                  <input id="custFotos" type="number" min="0" value="0" />
                </div>
                <div class="mini">
                  <label>V√≠deos</label>
                  <input id="custVideos" type="number" min="0" value="0" />
                </div>
              </div>

              <div class="mini-grid" style="margin-top:10px">
                <div class="mini">
                  <label>Plataforma / Rede</label>
                  <select id="custPlataforma">
                    <option value="reels">Instagram Reels</option>
                    <option value="tiktok">TikTok</option>
                    <option value="insta">Instagram Feed</option>
                    <option value="shorts">YouTube Shorts</option>
                    <option value="ytlong">YouTube (v√≠deo normal)</option>
                    <option value="facebookreels">Facebook Reels</option>
                    <option value="kwai">Kwai</option>
                    <option value="snap">Snapchat Spotlight</option>
                    <option value="pinterest">Pinterest Idea Pins</option>
                    <option value="linkedin">LinkedIn</option>
                    <option value="x">X (Twitter)</option>
                  </select>
                </div>
                <div class="mini">
                  <label>Tipo de v√≠deo</label>
                  <select id="custTipoVideo">
                    <option value="15">Curto (at√© 15s)</option>
                    <option value="45">M√©dio (30‚Äì45s)</option>
                    <option value="60">Longo (at√© 60s)</option>
                  </select>
                </div>
              </div>

              <div class="checks" style="margin-top:10px">
                <label class="chk"><input data-custom-opt id="optCorCine" type="checkbox" /> Cor cinematogr√°fica (v√≠deos)</label>
                <label class="chk"><input data-custom-opt id="optLegenda" type="checkbox" /> Legendas (v√≠deos)</label>
                <label class="chk"><input data-custom-opt id="optTransicoes" type="checkbox" /> Transi√ß√µes premium (v√≠deos)</label>
                <label class="chk"><input data-custom-opt id="optMotion" type="checkbox" /> Motion graphics (t√≠tulos) (v√≠deos)</label>
                <label class="chk"><input data-custom-opt id="optIntroOutro" type="checkbox" /> Intro/Outro + CTA (v√≠deos)</label>
                <label class="chk"><input data-custom-opt id="optEstabilizar" type="checkbox" /> Estabiliza√ß√£o (v√≠deos)</label>
                <label class="chk"><input data-custom-opt id="optSpeedRamp" type="checkbox" /> Speed ramp / slow motion (v√≠deos)</label>

                <label class="chk"><input data-custom-opt id="optSFX" type="checkbox" /> Efeitos sonoros (SFX) (v√≠deos)</label>
                <label class="chk"><input data-custom-opt id="optAudio" type="checkbox" /> Melhorar √°udio + reduzir ru√≠do (v√≠deos)</label>
                <label class="chk"><input data-custom-opt id="optMusicSync" type="checkbox" /> Sincronizar cortes com m√∫sica (v√≠deos)</label>
                <label class="chk"><input data-custom-opt id="optVoiceClean" type="checkbox" /> Limpeza de voz / clareza (v√≠deos)</label>

                <label class="chk"><input data-custom-opt id="optRetoquePro" type="checkbox" /> Retoque avan√ßado (fotos)</label>
                <label class="chk"><input data-custom-opt id="optPele" type="checkbox" /> Suavizar pele (fotos)</label>
                <label class="chk"><input data-custom-opt id="optFundo" type="checkbox" /> Remover/alterar fundo (fotos)</label>
                <label class="chk"><input data-custom-opt id="optCoresFoto" type="checkbox" /> Cor cinematogr√°fica (fotos)</label>
                <label class="chk"><input data-custom-opt id="optHDR" type="checkbox" /> HDR / nitidez premium (fotos)</label>
                <label class="chk"><input data-custom-opt id="optObjeto" type="checkbox" /> Remover objetos (fotos)</label>
                <label class="chk"><input data-custom-opt id="optTexto" type="checkbox" /> Texto/arte simples (fotos)</label>

                <label class="chk"><input data-custom-opt id="optThumbnail" type="checkbox" /> Thumbnail (capa) (1 unidade)</label>
                <label class="chk"><input data-custom-opt id="optUrgente" type="checkbox" /> Prioridade (entrega mais r√°pida)</label>
              </div>

              <div class="field" style="margin-top:12px">
                <label>Categoria detalhada</label>
                <textarea id="custDetalhe" placeholder="Descreva exatamente como voc√™ quer: estilo, refer√™ncia, cores, cortes, m√∫sicas, legendas, plataformas, etc..."></textarea>
              </div>

              <div class="total-box">
                <div class="total-line"><span>Valor total</span><strong id="custTotal">R$ 0</strong></div>
                <div class="total-sub">Entrega estimada: <strong id="custEntrega">13h30</strong> (m√≠nimo)</div>
              </div>

              <button class="btn" type="button" onclick="confirmCustom()">Continuar com o personalizado</button>
              <div class="hint">* Os pre√ßos por item s√£o internos e n√£o aparecem.</div>
            </div>
          </div>

          <button class="btn secondary" style="margin-top:18px" type="button" onclick="goBackStart()">Voltar</button>
        </section>

        <!-- ‚úÖ Sele√ß√£o de Editor (Cliente) -->
        <section id="screenPickEditor" class="screen">
          <div class="section-title">Escolha seu Editor ‚≠ê</div>
          <div class="pill">Voc√™ ver√° editores compat√≠veis com o seu pedido (avalia√ß√£o come√ßa em 5 estrelas).</div>

          <div class="toolbar">
            <div class="left">
              <span class="chip" id="pickInfo">Pedido: ‚Äî</span>
              <span class="chip">Avalia√ß√£o: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
            </div>
            <div class="right">
              <select id="pickSort" style="min-width:240px">
                <option value="best">Melhores avaliados</option>
                <option value="fast">Mais r√°pidos (simulado)</option>
              </select>
            </div>
          </div>

          <div id="editorsGrid" class="editor-cards"></div>

          <button class="btn secondary" style="margin-top:18px" type="button" onclick="backToOrder()">Voltar</button>
        </section>

        <!-- ‚úÖ EDITOR DASHBOARD -->
        <section id="screenEditor" class="screen">
          <div class="section-title">Bem-vindo, <span id="editorName">Editor</span> üëã</div>
          <div class="pill">Complete seu perfil, selecione pacotes e fique dispon√≠vel para receber pedidos.</div>

          <div class="editor-grid">
            <!-- Perfil -->
            <div class="card">
              <div class="row-inline">
                <h3 style="margin:0;color:#c7d2fe">Seu perfil (Editor)</h3>

                <label class="switch" title="Aparecer para clientes">
                  <input id="edAvailable" type="checkbox" />
                  <span class="track"><span class="thumb"></span></span>
                  <span>
                    <div class="label">Dispon√≠vel</div>
                    <div class="sub" id="edAvailText">Off</div>
                  </span>
                </label>
              </div>

              <div class="who" style="margin-top:12px">
                <div class="avatar" id="editorAvatarBox"></div>
                <div class="meta">
                  <div style="font-weight:900" id="editorFullName">Editor</div>
                  <div class="stars" id="editorStars"></div>
                </div>
              </div>

              <div class="uploadRow">
                <label class="btn secondary small" style="cursor:pointer">
                  Enviar foto
                  <input id="editorPhoto" type="file" accept="image/*" style="display:none">
                </label>
                <button class="btn secondary small" type="button" onclick="removeEditorPhoto()">Remover</button>
                <div class="hint" style="margin-top:0">* Foto opcional (salva no navegador).</div>
              </div>

              <!-- KPIs √∫teis (sem comiss√£o/admin aqui) -->
              <div class="kpi">
                <div class="k">
                  <div class="t">Avalia√ß√£o</div>
                  <div class="v"><span id="edRatingTxt">5.0</span><small>/5</small></div>
                  <div class="stars" id="edStarsRow" style="margin-top:6px"></div>
                </div>
                <div class="k">
                  <div class="t">Conclu√≠dos</div>
                  <div class="v"><span id="edDone">0</span><small> pedidos</small></div>
                </div>
                <div class="k">
                  <div class="t">Status</div>
                  <div class="v"><span id="edStatus">Novo</span></div>
                </div>
              </div>

              <div class="mini-grid" style="margin-top:12px">
                <div class="mini">
                  <label>Experi√™ncia</label>
                  <select id="edXp">
                    <option value="iniciante">Iniciante</option>
                    <option value="intermediario">Intermedi√°rio</option>
                    <option value="avancado">Avan√ßado</option>
                  </select>
                </div>
                <div class="mini">
                  <label>WhatsApp (opcional)</label>
                  <input id="edWhats" placeholder="(DDD) 99999-9999" />
                </div>
              </div>

              <div class="field" style="margin-top:10px">
                <label>Bio (curta e forte)</label>
                <textarea id="edBio" placeholder="Ex: cortes r√°pidos + cor cinematogr√°fica + √°udio limpo. Especialista em Reels e TikTok."></textarea>
              </div>

              <div class="mini-grid" style="margin-top:10px">
                <div class="mini">
                  <label>Softwares</label>
                  <input id="edSoft" placeholder="CapCut, Premiere, Lightroom..." />
                </div>
                <div class="mini">
                  <label>Portf√≥lio (link)</label>
                  <input id="edPortfolio" placeholder="https://..." />
                </div>
              </div>

              <div class="field" style="margin-top:10px">
                <label>Tags (separe por v√≠rgula)</label>
                <input id="edTags" placeholder="Reels, TikTok, Motion, Cor cine, Foto pro, √Åudio..." />
                <div id="edTagsPreview" class="tags"></div>
              </div>

              <div class="mini-grid" style="margin-top:12px">
                <button class="btn" type="button" onclick="saveEditorProfile()">Salvar perfil</button>
                <button class="btn secondary" type="button" onclick="resetEditor()">Reset (demo)</button>
              </div>

              <div class="hint">
                * Comiss√£o √© fixa e s√≥ aparece no painel ADM no futuro (Karamello 25% / Editor 75%).
              </div>
            </div>

            <!-- Pacotes -->
            <div class="card">
              <h3>Pacotes que voc√™ quer trabalhar</h3>
              <p>Marque os pacotes que voc√™ aceita. Assim voc√™ s√≥ aparece em pedidos compat√≠veis.</p>

              <div class="mini-grid" style="margin-top:10px">
                <div class="mini">
                  <label>Buscar pacote</label>
                  <input id="edSearchPkg" placeholder="Ex: Foto, Short, 45s..." />
                </div>
                <div class="mini">
                  <label>Atalhos</label>
                  <select id="edQuick">
                    <option value="all">‚Äî</option>
                    <option value="video">S√≥ V√≠deo</option>
                    <option value="foto">S√≥ Foto</option>
                    <option value="mix">Mix (Foto + V√≠deo)</option>
                    <option value="audio">√Åudio</option>
                  </select>
                </div>
              </div>

              <div id="editorPackages" class="pkg-list"></div>

              <!-- ‚úÖ BOT√ÉO SETA: mostra s√≥ 5 e abre o resto -->
              <div class="moreRow">
                <button class="btn secondary small" id="toggleMorePkgs" type="button" onclick="toggleMorePackages()">
                  Ver mais pacotes ‚Üì
                </button>
              </div>

              <div class="total-box" style="margin-top:12px">
                <div class="total-line">
                  <span>Selecionados</span>
                  <strong id="edPkgCount">0</strong>
                </div>
                <div class="total-sub" id="edPkgHint">Dica: selecione pelo menos 1 pacote para aparecer para clientes.</div>
              </div>

              <div class="mini-grid" style="margin-top:12px">
                <button class="btn" type="button" onclick="saveEditorPackages()">Salvar pacotes</button>
                <button class="btn secondary" type="button" onclick="selectAllEditorPackages(true)">Marcar todos</button>
              </div>
              <button class="btn secondary" type="button" onclick="selectAllEditorPackages(false)" style="margin-top:10px">Desmarcar todos</button>

              <div class="hint">* Sem backend: isso √© salvo no seu navegador (LocalStorage).</div>
            </div>
          </div>

          <!-- Preview p√∫blico -->
          <div class="section-title" style="margin-top:22px">Como voc√™ aparece para o cliente</div>
          <div class="pill">Esse √© o card que vai aparecer na tela de escolha do editor.</div>

          <div class="editor-cards" style="margin-top:12px">
            <div class="eCard" id="edPublicPreview"></div>
          </div>

          <button class="btn secondary" style="margin-top:18px" type="button" onclick="goBackStart()">Voltar</button>
        </section>

      </div>
    </main>

    <footer>¬© 2026 ‚Ä¢ Karamello ‚Ä¢ Edi√ß√£o profissional</footer>
  </div>

  <!-- MODAL CADASTRO -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <div id="modal" class="modal" role="dialog" aria-modal="true">
      <div class="modalHead">
        <strong id="titleCadastro">Criar conta</strong>
        <button class="close" type="button" onclick="closeCadastro()">√ó</button>
      </div>
      <div class="modalBody">
        <div class="field"><label>Nome</label><input id="inNome" placeholder="Seu nome" /></div>
        <div class="field"><label>Sobrenome</label><input id="inSobrenome" placeholder="Seu sobrenome" /></div>
        <div class="field"><label>Data de nascimento</label><input id="inData" type="date" /></div>
        <div class="field"><label>Email</label><input id="inEmail" type="email" placeholder="seuemail@gmail.com" /></div>
        <div class="field"><label>Senha</label><input id="inSenha" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" /></div>

        <button id="btnCadastrar" class="btn" type="button">Continuar</button>
        <button class="btn secondary" type="button" onclick="alert('Entrar com Google: em breve (precisa backend).')">Entrar com Google (em breve)</button>
        <div class="hint">* Login real com Google e seguran√ßa total entram na etapa futura (backend).</div>
      </div>
    </div>
  </div>

  <script>
    // ===== Util =====
    function escapeHtml(str){
      return String(str ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }
    function brl(v){ return Number(v||0).toLocaleString('pt-BR', {style:'currency', currency:'BRL'}); }

    function renderStarsHTML(value, max=5){
      const v = Math.max(0, Math.min(max, Number(value||0)));
      const full = Math.round(v); // aqui √© sempre 5, mas fica pronto
      let html = "";
      for(let i=0;i<full;i++) html += `<span class="star">‚òÖ</span>`;
      for(let i=full;i<max;i++) html += `<span class="star off">‚òÖ</span>`;
      html += `<small>${v.toFixed(1)}/${max}</small>`;
      return html;
    }

    function setAvatar(el, photoDataUrl, fallbackText){
      if(!el) return;
      el.innerHTML = "";
      if(photoDataUrl){
        const img = document.createElement("img");
        img.src = photoDataUrl;
        el.appendChild(img);
      }else{
        el.textContent = (fallbackText || "K").slice(0,1).toUpperCase();
      }
    }

    function readFileAsDataURL(file){
      return new Promise((resolve, reject)=>{
        const r = new FileReader();
        r.onload = () => resolve(String(r.result||""));
        r.onerror = reject;
        r.readAsDataURL(file);
      });
    }

    function lsGet(key, fallback){
      try{
        const raw = localStorage.getItem(key);
        if(!raw) return fallback;
        return JSON.parse(raw);
      }catch(e){ return fallback; }
    }
    function lsSet(key, value){
      try{ localStorage.setItem(key, JSON.stringify(value)); }catch(e){}
    }

    // ===== Base (screens) =====
    const overlay = document.getElementById('overlay');
    const modal = document.getElementById('modal');
    const titleCadastro = document.getElementById('titleCadastro');
    const btnCadastrar = document.getElementById('btnCadastrar');

    const screenStart = document.getElementById('screenStart');
    const screenClientProfile = document.getElementById('screenClientProfile');
    const screenClient = document.getElementById('screenClient');
    const screenPickEditor = document.getElementById('screenPickEditor');
    const screenEditor = document.getElementById('screenEditor');

    const inNome = document.getElementById('inNome');
    const inSobrenome = document.getElementById('inSobrenome');

    const clientName = document.getElementById('clientName');
    const editorName = document.getElementById('editorName');

    let role = null;
    let currentOrder = null;

    function openCadastro(tipo){
      role = tipo;
      titleCadastro.textContent = (tipo === 'cliente') ? 'Criar conta como Cliente' : 'Criar conta como Editor';
      overlay.classList.remove('closing');
      modal.classList.remove('closing');
      overlay.classList.add('show');
      overlay.setAttribute('aria-hidden','false');
      modal.style.animation = 'none'; void modal.offsetHeight; modal.style.animation = '';
    }
    function closeCadastro(){
      overlay.classList.add('closing');
      modal.classList.add('closing');
      setTimeout(() => {
        overlay.classList.remove('show','closing');
        modal.classList.remove('closing');
        overlay.setAttribute('aria-hidden','true');
      }, 220);
    }
    overlay.addEventListener('click', (e) => { if(e.target === overlay) closeCadastro(); });

    function showScreen(which){
      [screenStart, screenClientProfile, screenClient, screenPickEditor, screenEditor].forEach(s => s.classList.remove('show'));
      setTimeout(() => {
        which.classList.add('show');
        window.scrollTo({top:0, behavior:'smooth'});
      }, 50);
    }
    function goBackStart(){ showScreen(screenStart); }

    // ===== Storage =====
    const LS_EDITOR = "karamello_editor_v6";
    const LS_CLIENT = "karamello_client_v2";

    // ===== Pacotes =====
    const packages = [
      {id:1,  name:'Starter Foto',     price:27.40, eta:'13h30', items:['1 Foto (b√°sica)','Cor + nitidez']},
      {id:2,  name:'Duo Foto',         price:41.80, eta:'13h30', items:['2 Fotos (b√°sicas)','Cor + nitidez']},
      {id:3,  name:'Foto Pro 3',       price:53.60, eta:'14h30', items:['3 Fotos (pro)','Ajustes finos + cor']},
      {id:4,  name:'V√≠deo Short 15s',  price:63.90, eta:'14h30', items:['1 V√≠deo curto (at√© 15s)','Cortes + ritmo']},
      {id:5,  name:'Foto Pack 4',      price:73.50, eta:'15h00', items:['4 Fotos (pro)','Cor + detalhes']},
      {id:6,  name:'Short Duo',        price:86.40, eta:'15h30', items:['2 V√≠deos curtos (at√© 15s)','Cortes + transi√ß√µes simples']},
      {id:7,  name:'Combo Social',     price:96.80, eta:'16h00', items:['1 Foto + 1 V√≠deo curto','Look cinematogr√°fico leve']},
      {id:8,  name:'Foto Pack 5',      price:108.90,eta:'18h00', items:['5 Fotos (pro)','Padroniza√ß√£o de cor']},
      {id:9,  name:'Short Trio',       price:132.70,eta:'18h00', items:['3 V√≠deos curtos (at√© 15s)','Cor + ritmo']},
      {id:10, name:'Foto Pack 8',      price:151.40,eta:'24h',   items:['8 Fotos (pro)','Cor + retoques leves']},
      {id:11, name:'Short 5',          price:176.90,eta:'24h',   items:['5 V√≠deos curtos','Cortes + cor']},
      {id:12, name:'Creator Mix',      price:197.80,eta:'24h',   items:['10 Fotos + 1 V√≠deo curto','Padroniza√ß√£o completa']},
      {id:13, name:'V√≠deo M√©dio 45s',  price:221.60,eta:'24h',   items:['1 V√≠deo m√©dio (30‚Äì45s)','Cor + transi√ß√µes']},
      {id:14, name:'V√≠deo Longo 60s',  price:259.40,eta:'48h',   items:['1 V√≠deo longo (at√© 60s)','Edi√ß√£o avan√ßada']},
      {id:15, name:'Premium Creator',  price:329.90,eta:'48h',   items:['15 Fotos + 3 V√≠deos curtos','Look premium + revis√£o']},
    ];

    function renderPackages(){
      const grid = document.getElementById('packagesGrid');
      grid.innerHTML = '';
      packages.forEach(p => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <h3>${p.id}. ${escapeHtml(p.name)}</h3>
          <p>Entrega a partir de <strong>${escapeHtml(p.eta)}</strong> (m√≠nimo 13h30)</p>
          <div class="price">${brl(p.price)}</div>
          <ul>${p.items.map(i=>`<li>${escapeHtml(i)}</li>`).join('')}</ul>
          <button class="btn" type="button" onclick="choosePackage(${p.id})">Escolher pacote</button>
        `;
        grid.appendChild(card);
      });
    }

    // ===== CLIENTE (perfil) =====
    const clientAvatarBox = document.getElementById("clientAvatarBox");
    const clientAvatarTop = document.getElementById("clientAvatarTop");
    const clientProfileName = document.getElementById("clientProfileName");
    const clientStars = document.getElementById("clientStars");
    const clientStarsTop = document.getElementById("clientStarsTop");

    const clientPhoto = document.getElementById("clientPhoto");
    const clWhats = document.getElementById("clWhats");
    const clCity = document.getElementById("clCity");
    const clNiche = document.getElementById("clNiche");
    const clMainPlatform = document.getElementById("clMainPlatform");
    const clAbout = document.getElementById("clAbout");

    let clientData = lsGet(LS_CLIENT, null);

    function ensureClientData(nome, sobrenome){
      const full = `${nome} ${sobrenome}`.trim();
      clientData = clientData || {
        first:nome||"Cliente",
        last:sobrenome||"",
        full: full || "Cliente",
        stars: 5.0,
        photo: "",
        whats:"",
        city:"",
        niche:"",
        mainPlatform:"instagram",
        about:""
      };
      clientData.first = nome || clientData.first;
      clientData.last = sobrenome || clientData.last;
      clientData.full = full || clientData.full;
      clientData.stars = 5.0; // ‚úÖ sempre come√ßa com 5
      lsSet(LS_CLIENT, clientData);
    }

    function paintClientProfile(){
      clientProfileName.textContent = clientData?.full || "Cliente";
      clientStars.innerHTML = renderStarsHTML(5.0, 5);

      setAvatar(clientAvatarBox, clientData?.photo, (clientData?.full||"C")[0]);
      clWhats.value = clientData?.whats || "";
      clCity.value = clientData?.city || "";
      clNiche.value = clientData?.niche || "";
      clMainPlatform.value = clientData?.mainPlatform || "instagram";
      clAbout.value = clientData?.about || "";
    }

    function paintClientTop(){
      clientName.textContent = clientData?.first || "Cliente";
      clientStarsTop.innerHTML = renderStarsHTML(5.0, 5);
      setAvatar(clientAvatarTop, clientData?.photo, (clientData?.full||"C")[0]);
    }

    clientPhoto?.addEventListener("change", async (e)=>{
      const file = e.target.files?.[0];
      if(!file) return;
      const data = await readFileAsDataURL(file);
      clientData.photo = data;
      lsSet(LS_CLIENT, clientData);
      paintClientProfile();
      paintClientTop();
    });

    function removeClientPhoto(){
      if(!clientData) return;
      clientData.photo = "";
      lsSet(LS_CLIENT, clientData);
      paintClientProfile();
      paintClientTop();
    }

    function saveClientProfileAndGo(){
      clientData.whats = (clWhats.value||"").trim();
      clientData.city = (clCity.value||"").trim();
      clientData.niche = (clNiche.value||"").trim();
      clientData.mainPlatform = clMainPlatform.value || "instagram";
      clientData.about = (clAbout.value||"").trim();
      clientData.stars = 5.0;
      lsSet(LS_CLIENT, clientData);

      paintClientTop();
      showScreen(screenClient);
      setTimeout(()=>{ renderPackages(); calcCustom(); }, 80);
    }

    // ===== CUSTOM (Cliente) =====
    const custFotos = document.getElementById('custFotos');
    const custVideos = document.getElementById('custVideos');
    const custPlataforma = document.getElementById('custPlataforma');
    const custTipoVideo = document.getElementById('custTipoVideo');
    const custTotal = document.getElementById('custTotal');
    const custEntrega = document.getElementById('custEntrega');

    const PRICES = {
      foto: 21.40,
      video15: 44.90,
      video45: 66.70,
      video60: 84.60,
      platformMult: {
        reels:1.00, tiktok:1.00, insta:1.04, shorts:1.04,
        ytlong:1.06, facebookreels:1.02, kwai:1.00, snap:1.02,
        pinterest:1.02, linkedin:1.03, x:1.02
      }
    };

    const EXTRA_OPTIONS = [
      { id:'optCorCine',    kind:'video', price:11.60 },
      { id:'optLegenda',    kind:'video', price:11.60 },
      { id:'optTransicoes', kind:'video', price:9.40  },
      { id:'optMotion',     kind:'video', price:11.60 },
      { id:'optIntroOutro', kind:'video', price:11.60 },
      { id:'optEstabilizar',kind:'video', price:11.60 },
      { id:'optSpeedRamp',  kind:'video', price:9.40  },

      { id:'optSFX',        kind:'video', price:9.40  },
      { id:'optAudio',      kind:'video', price:11.60 },
      { id:'optMusicSync',  kind:'video', price:9.90  },
      { id:'optVoiceClean', kind:'video', price:11.90 },

      { id:'optRetoquePro', kind:'photo', price:9.40  },
      { id:'optPele',       kind:'photo', price:9.40  },
      { id:'optFundo',      kind:'photo', price:11.60 },
      { id:'optCoresFoto',  kind:'photo', price:9.40  },
      { id:'optHDR',        kind:'photo', price:9.40  },
      { id:'optObjeto',     kind:'photo', price:11.60 },
      { id:'optTexto',      kind:'photo', price:9.40  },

      { id:'optThumbnail',  kind:'order', price:19.90 },
      { id:'optUrgente',    kind:'order', price:29.90 },
    ];

    function calcEntrega(total, urgent){
      let eta = '13h30';
      if(total <= 120) eta = '13h30';
      else if(total <= 250) eta = '14h30';
      else if(total <= 400) eta = '18h00';
      else if(total <= 700) eta = '24h';
      else eta = '48h';

      if(urgent){
        if(eta === '48h') eta = '24h';
        else if(eta === '24h') eta = '18h00';
        else if(eta === '18h00') eta = '14h30';
        else eta = '13h30';
      }
      return eta;
    }

    function calcCustom(){
      const fotos = Math.max(0, parseInt(custFotos.value||'0',10));
      const vids  = Math.max(0, parseInt(custVideos.value||'0',10));
      const plat  = custPlataforma.value||'reels';
      const tipo  = custTipoVideo.value||'15';

      let unitVideo = PRICES.video15;
      if(tipo==='45') unitVideo = PRICES.video45;
      if(tipo==='60') unitVideo = PRICES.video60;

      const mult = PRICES.platformMult[plat] ?? 1.0;

      let extraVideo=0, extraPhoto=0, extraOrder=0;
      EXTRA_OPTIONS.forEach(o=>{
        const el=document.getElementById(o.id);
        if(!el||!el.checked) return;
        if(o.kind==='video') extraVideo+=o.price;
        else if(o.kind==='photo') extraPhoto+=o.price;
        else extraOrder+=o.price;
      });

      const rawTotal = (fotos*(PRICES.foto+extraPhoto)) + (vids*(unitVideo*mult+extraVideo)) + extraOrder;
      const jitter = (fotos+vids)>0 ? (0.30 + ((fotos*7 + vids*11)%7)*0.10) : 0;
      const total = Math.max(0, rawTotal + jitter);

      custTotal.textContent = brl(total);
      const urgent = document.getElementById('optUrgente')?.checked || false;
      custEntrega.textContent = calcEntrega(total, urgent);
    }

    [custFotos,custVideos,custPlataforma,custTipoVideo].forEach(el=>{
      el.addEventListener('input', calcCustom);
      el.addEventListener('change', calcCustom);
    });
    Array.from(document.querySelectorAll('[data-custom-opt]')).forEach(el=>{
      el.addEventListener('change', calcCustom);
    });

    // ===== Pedido -> Escolher Editor =====
    function choosePackage(id){
      const p = packages.find(x => x.id === id);
      currentOrder = {
        kind: "package",
        packageId: p.id,
        title: `${p.id}. ${p.name}`,
        total: p.price,
        eta: p.eta
      };
      startPickEditor();
    }

    function confirmCustom(){
      currentOrder = {
        kind: "custom",
        title: "Pacote Personalizado",
        totalText: custTotal.textContent,
        eta: custEntrega.textContent,
        fotos: parseInt(custFotos.value||"0",10),
        videos: parseInt(custVideos.value||"0",10)
      };
      startPickEditor();
    }

    function startPickEditor(){
      const pickInfo = document.getElementById("pickInfo");
      if(currentOrder?.kind === "package"){
        pickInfo.textContent = `Pedido: ${currentOrder.title} ‚Ä¢ ${brl(currentOrder.total)} ‚Ä¢ ${currentOrder.eta}`;
      }else{
        pickInfo.textContent = `Pedido: Personalizado ‚Ä¢ ${currentOrder.totalText} ‚Ä¢ ${currentOrder.eta}`;
      }
      renderPickEditors();
      showScreen(screenPickEditor);
    }

    function backToOrder(){
      showScreen(screenClient);
    }

    // ===== EDITOR (dashboard) =====
    const editorAvatarBox = document.getElementById("editorAvatarBox");
    const editorFullName = document.getElementById("editorFullName");
    const editorStars = document.getElementById("editorStars");

    const editorPhoto = document.getElementById("editorPhoto");
    const edAvailable = document.getElementById("edAvailable");
    const edAvailText = document.getElementById("edAvailText");

    const edRatingTxt = document.getElementById("edRatingTxt");
    const edStarsRow = document.getElementById("edStarsRow");
    const edDone = document.getElementById("edDone");
    const edStatus = document.getElementById("edStatus");

    const edXp = document.getElementById("edXp");
    const edWhats = document.getElementById("edWhats");
    const edBio = document.getElementById("edBio");
    const edSoft = document.getElementById("edSoft");
    const edPortfolio = document.getElementById("edPortfolio");
    const edTags = document.getElementById("edTags");
    const edTagsPreview = document.getElementById("edTagsPreview");

    const edSearchPkg = document.getElementById("edSearchPkg");
    const edQuick = document.getElementById("edQuick");
    const edPkgCount = document.getElementById("edPkgCount");
    const edPkgHint = document.getElementById("edPkgHint");
    const edPublicPreview = document.getElementById("edPublicPreview");

    let editorData = lsGet(LS_EDITOR, null);

    function ensureEditorData(nome, sobrenome){
      const full = `${nome} ${sobrenome}`.trim();
      editorData = editorData || {
        first:nome||"Editor",
        last:sobrenome||"",
        full: full || "Editor",
        stars: 5.0,
        photo: "",
        available:false,
        xp:"iniciante",
        whats:"",
        bio:"",
        soft:"",
        portfolio:"",
        tags:[],
        done:0,
        status:"Novo",
        packages:[]
      };
      editorData.first = nome || editorData.first;
      editorData.last = sobrenome || editorData.last;
      editorData.full = full || editorData.full;
      editorData.stars = 5.0; // ‚úÖ sempre come√ßa com 5
      lsSet(LS_EDITOR, editorData);
    }

    function paintEditor(){
      editorName.textContent = editorData?.first || "Editor";
      editorFullName.textContent = editorData?.full || "Editor";

      editorStars.innerHTML = renderStarsHTML(5.0,5);
      edRatingTxt.textContent = "5.0";
      edStarsRow.innerHTML = renderStarsHTML(5.0,5);

      edDone.textContent = String(editorData?.done || 0);
      edStatus.textContent = editorData?.status || "Novo";

      edAvailable.checked = !!editorData?.available;
      edAvailText.textContent = editorData?.available ? "On" : "Off";

      edXp.value = editorData?.xp || "iniciante";
      edWhats.value = editorData?.whats || "";
      edBio.value = editorData?.bio || "";
      edSoft.value = editorData?.soft || "";
      edPortfolio.value = editorData?.portfolio || "";
      edTags.value = (editorData?.tags || []).join(", ");

      setAvatar(editorAvatarBox, editorData?.photo, (editorData?.full||"E")[0]);

      renderTagsPreview();
      renderEditorPackages();
      updatePkgCount();
      renderPublicPreview();
    }

    editorPhoto?.addEventListener("change", async (e)=>{
      const file = e.target.files?.[0];
      if(!file) return;
      const data = await readFileAsDataURL(file);
      editorData.photo = data;
      lsSet(LS_EDITOR, editorData);
      paintEditor();
    });

    function removeEditorPhoto(){
      if(!editorData) return;
      editorData.photo = "";
      lsSet(LS_EDITOR, editorData);
      paintEditor();
    }

    edAvailable?.addEventListener("change", ()=>{
      editorData.available = !!edAvailable.checked;
      edAvailText.textContent = editorData.available ? "On" : "Off";
      lsSet(LS_EDITOR, editorData);
      renderPublicPreview();
    });

    function renderTagsPreview(){
      const raw = (edTags.value||"").split(",").map(s=>s.trim()).filter(Boolean).slice(0,12);
      edTagsPreview.innerHTML = raw.map(t=>`<span class="tag blue">${escapeHtml(t)}</span>`).join("");
    }
    edTags?.addEventListener("input", ()=>{
      renderTagsPreview();
    });

    function saveEditorProfile(){
      editorData.xp = edXp.value || "iniciante";
      editorData.whats = (edWhats.value||"").trim();
      editorData.bio = (edBio.value||"").trim();
      editorData.soft = (edSoft.value||"").trim();
      editorData.portfolio = (edPortfolio.value||"").trim();
      editorData.tags = (edTags.value||"").split(",").map(s=>s.trim()).filter(Boolean).slice(0,12);
      editorData.stars = 5.0;
      lsSet(LS_EDITOR, editorData);
      renderPublicPreview();
      alert("Perfil do editor salvo (demo).");
    }

    function resetEditor(){
      localStorage.removeItem(LS_EDITOR);
      editorData = null;
      alert("Reset feito. Reabra como Editor para criar de novo.");
      goBackStart();
    }

    // ===== Pacotes do Editor (com: thumbs + s√≥ 5 + seta + atalho √Åudio + √°udio no 9+) =====
    let showAllPackages = false;

    function toggleMorePackages(){
      showAllPackages = !showAllPackages;
      document.getElementById("toggleMorePkgs").textContent = showAllPackages ? "Mostrar menos ‚Üë" : "Ver mais pacotes ‚Üì";
      renderEditorPackages();
    }

    function updatePkgCount(){
      const count = (editorData?.packages || []).length;
      edPkgCount.textContent = String(count);
      edPkgHint.textContent = count ? "Perfeito: voc√™ vai aparecer em pedidos compat√≠veis." : "Dica: selecione pelo menos 1 pacote para aparecer para clientes.";
    }

    function renderEditorPackages(){
      const wrap = document.getElementById("editorPackages");
      if(!wrap) return;

      const search = (edSearchPkg?.value || "").toLowerCase().trim();
      const quick = (edQuick?.value || "all");

      // se a pessoa come√ßar a filtrar, j√° abre o restante para facilitar
      if((search && !showAllPackages) || (quick !== "all" && !showAllPackages)){
        showAllPackages = true;
        const btn = document.getElementById("toggleMorePkgs");
        if(btn) btn.textContent = "Mostrar menos ‚Üë";
      }

      wrap.innerHTML = "";

      packages.forEach((p, index) => {
        // ‚úÖ regra: mostra s√≥ 5 se n√£o abriu
        if (!showAllPackages && index >= 5) return;

        const text = `${p.name} ${p.items.join(" ")}`.toLowerCase();
        if (search && !text.includes(search)) return;

        const isVideo = p.name.toLowerCase().includes("v√≠deo") || p.name.toLowerCase().includes("short");
        const isFoto  = p.name.toLowerCase().includes("foto");
        const isMix   = p.name.toLowerCase().includes("combo") || p.name.toLowerCase().includes("mix") || (isVideo && isFoto);

        if (quick === "video" && !isVideo) return;
        if (quick === "foto" && !isFoto) return;
        if (quick === "mix" && !isMix) return;
        if (quick === "audio" && index < 8) return; // ‚úÖ √°udio a partir do pacote 9

        const checked = (editorData?.packages || []).includes(p.id);
        const audioExtras = (index >= 8)
          ? `<div class="pkg-meta">üéß Ajustes de √°udio inclu√≠dos</div>`
          : "";

        const el = document.createElement("label");
        el.className = "pkg-item";
        el.innerHTML = `
          <div class="pkg-thumb"></div>
          <div>
            <div style="display:flex; gap:10px; align-items:flex-start;">
              <input type="checkbox" data-pkg="${p.id}" ${checked ? "checked" : ""}>
              <div>
                <div class="pkg-title">${p.id}. ${escapeHtml(p.name)}</div>
                <div class="pkg-sub">Entrega: ${escapeHtml(p.eta)} ‚Ä¢ ${brl(p.price)}</div>
              </div>
            </div>
            <div class="pkg-meta">${p.items.map(x=>escapeHtml(x)).join(" ‚Ä¢ ")}</div>
            ${audioExtras}
          </div>
        `;
        wrap.appendChild(el);
      });

      // listeners
      wrap.querySelectorAll('input[type="checkbox"][data-pkg]').forEach(chk=>{
        chk.addEventListener("change", ()=>{
          const id = Number(chk.getAttribute("data-pkg"));
          editorData.packages = editorData.packages || [];
          if(chk.checked && !editorData.packages.includes(id)) editorData.packages.push(id);
          if(!chk.checked) editorData.packages = editorData.packages.filter(x=>x!==id);
          lsSet(LS_EDITOR, editorData);
          updatePkgCount();
          renderPublicPreview();
        });
      });
    }

    edSearchPkg?.addEventListener("input", renderEditorPackages);
    edQuick?.addEventListener("change", renderEditorPackages);

    function selectAllEditorPackages(flag){
      editorData.packages = flag ? packages.map(p=>p.id) : [];
      lsSet(LS_EDITOR, editorData);
      renderEditorPackages();
      updatePkgCount();
      renderPublicPreview();
    }

    function saveEditorPackages(){
      lsSet(LS_EDITOR, editorData);
      alert("Pacotes salvos (demo).");
    }

    function renderPublicPreview(){
      const tags = (editorData?.tags || []).slice(0,8);
      const pkgs = (editorData?.packages || []).slice(0,6);

      const pkgBadges = pkgs.map(id=>{
        const p = packages.find(x=>x.id===id);
        return p ? `<span class="badge pillBlue">${escapeHtml(p.name)}</span>` : "";
      }).join("");

      const tagBadges = tags.map(t=>`<span class="badge">${escapeHtml(t)}</span>`).join("");

      const statusBadge = editorData?.available
        ? `<span class="badge you">Dispon√≠vel</span>`
        : `<span class="badge off">Indispon√≠vel</span>`;

      edPublicPreview.innerHTML = `
        <div class="eTop">
          <div style="display:flex; gap:10px; align-items:center;">
            <div class="avatar" style="width:48px;height:48px" id="pubAvatar"></div>
            <div>
              <div class="eName">${escapeHtml(editorData?.full || "Editor")}</div>
              <div class="stars" style="margin-top:4px">${renderStarsHTML(5.0,5)}</div>
              <div class="eMeta">${escapeHtml(editorData?.xp || "iniciante")} ‚Ä¢ ${escapeHtml(editorData?.soft || "Softwares")}</div>
            </div>
          </div>
          <div style="text-align:right">
            ${statusBadge}
            <div class="eMeta" style="margin-top:6px">Pacotes: <strong>${(editorData?.packages||[]).length}</strong></div>
          </div>
        </div>

        <div class="eBio">${escapeHtml(editorData?.bio || "Escreva uma bio curta e forte para aparecer melhor para clientes.")}</div>

        <div class="eBadges">
          ${tagBadges || `<span class="badge off">Sem tags</span>`}
        </div>

        <div class="eBadges" style="margin-top:10px">
          ${pkgBadges || `<span class="badge off">Sem pacotes selecionados</span>`}
        </div>

        <div class="hint" style="margin-top:10px">* Demo sem backend: informa√ß√µes ficam salvas no seu navegador.</div>
      `;

      // pinta avatar no preview
      const pubAvatar = document.getElementById("pubAvatar");
      setAvatar(pubAvatar, editorData?.photo, (editorData?.full||"E")[0]);
    }

    // ===== Tela ‚ÄúEscolher Editor‚Äù (demo) =====
    const DEMO_EDITORS = [
      { id:"d1", name:"Editor Neon",   xp:"avancado", tags:["Reels","TikTok","√Åudio"], packages:[4,6,9,11,13,14,15], available:true },
      { id:"d2", name:"Editor Flux",   xp:"intermediario", tags:["Foto pro","Cor cine"], packages:[1,2,3,5,8,10,12,15], available:true },
      { id:"d3", name:"Editor Pulse",  xp:"intermediario", tags:["Motion","Legendas"], packages:[4,6,7,9,11,13,15], available:true },
      { id:"d4", name:"Editor Vibe",   xp:"iniciante", tags:["Shorts","Cortes"], packages:[4,6,7,9], available:true },
      { id:"d5", name:"Editor Clean",  xp:"avancado", tags:["√Åudio","Ru√≠do","Voz"], packages:[9,11,13,14,15], available:true },
    ];

    function getAllEditors(){
      const list = [];
      // editor real (se existir)
      if(editorData){
        list.push({
          id:"you",
          name: editorData.full || "Voc√™",
          xp: editorData.xp || "iniciante",
          tags: editorData.tags || [],
          packages: editorData.packages || [],
          available: !!editorData.available,
          photo: editorData.photo || ""
        });
      }
      // demos
      DEMO_EDITORS.forEach(e=> list.push({...e, stars:5.0}));
      return list;
    }

    function isCompatible(editor, order){
      if(!editor.available) return false;

      if(order?.kind === "package"){
        return (editor.packages || []).includes(order.packageId);
      }

      // personalizado: regra simples
      const vids = Number(order?.videos||0);
      const fotos = Number(order?.fotos||0);

      if(vids > 0){
        // precisa ter algum pacote de v√≠deo (id 4+ geralmente)
        return (editor.packages||[]).some(id => {
          const p = packages.find(x=>x.id===id);
          const n = (p?.name||"").toLowerCase();
          return n.includes("v√≠deo") || n.includes("short");
        });
      }
      if(fotos > 0){
        return (editor.packages||[]).some(id => {
          const p = packages.find(x=>x.id===id);
          const n = (p?.name||"").toLowerCase();
          return n.includes("foto");
        });
      }
      return (editor.packages||[]).length > 0;
    }

    function renderPickEditors(){
      const grid = document.getElementById("editorsGrid");
      const sort = document.getElementById("pickSort")?.value || "best";
      const all = getAllEditors();

      let compatible = all.filter(e => isCompatible(e, currentOrder));

      if(sort === "fast"){
        const rank = { avancado:3, intermediario:2, iniciante:1 };
        compatible.sort((a,b)=>(rank[b.xp]||1)-(rank[a.xp]||1));
      }else{
        compatible.sort((a,b)=>5-5);
      }

      grid.innerHTML = "";
      if(!compatible.length){
        grid.innerHTML = `<div class="card full" style="grid-column:1/-1">
          <h3>Nenhum editor compat√≠vel (demo)</h3>
          <p>Pe√ßa para um editor marcar os pacotes compat√≠veis e ficar ‚ÄúDispon√≠vel‚Äù.</p>
        </div>`;
        return;
      }

      compatible.forEach(e=>{
        const you = e.id === "you";
        const card = document.createElement("div");
        card.className = "eCard";
        card.innerHTML = `
          <div class="eTop">
            <div style="display:flex; gap:10px; align-items:center;">
              <div class="avatar" style="width:46px;height:46px" id="pickAv_${e.id}">${escapeHtml(e.name[0])}</div>
              <div>
                <div class="eName">${escapeHtml(e.name)} ${you ? "‚Ä¢ (Voc√™)" : ""}</div>
                <div class="stars" style="margin-top:4px">${renderStarsHTML(5.0,5)}</div>
                <div class="eMeta">${escapeHtml(e.xp)} ‚Ä¢ Pacotes: ${e.packages?.length||0}</div>
              </div>
            </div>
            <div>
              <span class="badge ${e.available ? "you" : "off"}">${e.available ? "Dispon√≠vel" : "Off"}</span>
            </div>
          </div>

          <div class="eBio">${escapeHtml((e.tags||[]).slice(0,5).join(" ‚Ä¢ ") || "Editor demo")}</div>
          <div class="eBadges">
            ${(e.tags||[]).slice(0,6).map(t=>`<span class="badge pillBlue">${escapeHtml(t)}</span>`).join("") || `<span class="badge off">Sem tags</span>`}
          </div>

          <button class="btn" type="button" onclick="selectEditor('${e.id}')">Selecionar este editor</button>
          <div class="hint">* Demo: sem pagamento/entrega real ainda.</div>
        `;
        grid.appendChild(card);

        // avatar
        const av = document.getElementById(`pickAv_${e.id}`);
        if(av) setAvatar(av, e.photo || "", e.name[0]);
      });
    }

    document.getElementById("pickSort")?.addEventListener("change", renderPickEditors);

    function selectEditor(id){
      if(id === "you" && !editorData?.available){
        alert("Seu perfil est√° como OFF. Ative ‚ÄòDispon√≠vel‚Äô no painel do editor.");
        return;
      }
      alert("Editor selecionado! (demo)\nNa pr√≥xima etapa vamos criar: checkout + envio de arquivos + chat.");
    }

    // ===== Cadastro (modal) =====
    btnCadastrar.addEventListener('click', ()=>{
      const nome=(inNome.value||'').trim();
      const sobrenome=(inSobrenome.value||'').trim();
      if(!nome||!sobrenome){ alert('Preencha Nome e Sobrenome.'); return; }

      closeCadastro();

      if(role==='cliente'){
        ensureClientData(nome, sobrenome);
        clientProfileName.textContent = clientData.full;
        clientStars.innerHTML = renderStarsHTML(5.0,5);
        paintClientProfile();
        showScreen(screenClientProfile);
      }else{
        ensureEditorData(nome, sobrenome);
        paintEditor();
        showScreen(screenEditor);
      }
    });

    window.addEventListener('DOMContentLoaded', ()=>{
      // se j√° tiver dados salvos, mant√©m (sem for√ßar tela)
      clientData = lsGet(LS_CLIENT, clientData);
      editorData = lsGet(LS_EDITOR, editorData);
      calcCustom();
    });
  </script>
</body>
</html>

